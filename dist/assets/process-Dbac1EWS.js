function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/browserAll-DST3N2Qa.js","assets/webworkerAll-B3g9ODF4.js","assets/colorToUniform-BNpo0TII.js","assets/CanvasPool-B-6OnqwD.js","assets/batchSamplersUniformGroup-Ow5N7-GG.js","assets/modulepreload-polyfill-B5Qt9EMX.js","assets/WebGPURenderer-D7l_qpV8.js","assets/SharedSystems-BSqKXncm.js","assets/WebGLRenderer-Bh0isDr3.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import"./modulepreload-polyfill-B5Qt9EMX.js";const qr="modulepreload",Zr=function(s){return"/"+s},Js={},Ue=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){const n=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=Promise.all(e.map(h=>{if(h=Zr(h),h in Js)return;Js[h]=!0;const c=h.endsWith(".css"),l=c?'[rel="stylesheet"]':"";if(!!i)for(let f=n.length-1;f>=0;f--){const p=n[f];if(p.href===h&&(!c||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${l}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":qr,c||(d.as="script",d.crossOrigin=""),d.href=h,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}return r.then(()=>t()).catch(n=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n})};var k=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s))(k||{});const ds=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Ce=(s,t)=>ds(s).priority??t,nt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(ds).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...s){return s.map(ds).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,r=this._queue;i[e]?i[e]?.(t):(r[e]=r[e]||[],r[e]?.push(t))})}),this},handle(s,t,e){const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&(n[s]?.forEach(o=>t(o)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(n=>n.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((n,o)=>Ce(o.value,e)-Ce(n.value,e)))},i=>{const r=t.findIndex(n=>n.name===i.name);r!==-1&&t.splice(r,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>Ce(n,e)-Ce(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}},Kr={extension:{type:k.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ue(()=>import("./browserAll-DST3N2Qa.js"),__vite__mapDeps([0,1,2,3,4,5]))}},Qr={extension:{type:k.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ue(()=>import("./webworkerAll-B3g9ODF4.js"),__vite__mapDeps([1,2,3,4,5]))}};class et{constructor(t,e,i){this._x=e||0,this._y=i||0,this._observer=t}clone(t){return new et(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Rs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ni={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,c,l){this.fn=h,this.context=c,this.once=l||!1}function n(h,c,l,u,d){if(typeof l!="function")throw new TypeError("The listener must be a function");var f=new r(l,u||h,d),p=e?e+c:c;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,c){--h._eventsCount===0?h._events=new i:delete h._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},a.prototype.listeners=function(c){var l=e?e+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(c){var l=e?e+c:c,u=this._events[l];return u?u.fn?1:u.length:0},a.prototype.emit=function(c,l,u,d,f,p){var g=e?e+c:c;if(!this._events[g])return!1;var m=this._events[g],x=arguments.length,y,_;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,f),!0;case 6:return m.fn.call(m.context,l,u,d,f,p),!0}for(_=1,y=new Array(x-1);_<x;_++)y[_-1]=arguments[_];m.fn.apply(m.context,y)}else{var b=m.length,C;for(_=0;_<b;_++)switch(m[_].once&&this.removeListener(c,m[_].fn,void 0,!0),x){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,l);break;case 3:m[_].fn.call(m[_].context,l,u);break;case 4:m[_].fn.call(m[_].context,l,u,d);break;default:if(!y)for(C=1,y=new Array(x-1);C<x;C++)y[C-1]=arguments[C];m[_].fn.apply(m[_].context,y)}}return!0},a.prototype.on=function(c,l,u){return n(this,c,l,u,!1)},a.prototype.once=function(c,l,u){return n(this,c,l,u,!0)},a.prototype.removeListener=function(c,l,u,d){var f=e?e+c:c;if(!this._events[f])return this;if(!l)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var g=0,m=[],x=p.length;g<x;g++)(p[g].fn!==l||d&&!p[g].once||u&&p[g].context!==u)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var l;return c?(l=e?e+c:c,this._events[l]&&o(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a})(Ni);var Jr=Ni.exports;const Ct=Rs(Jr),tn=Math.PI*2,en=180/Math.PI,sn=Math.PI/180;class q{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new q(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return je.x=0,je.y=0,je}}const je=new q;class R{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new q;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new q;const i=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,h=this.ty,c=1/(i*o+n*-r),l=t.x,u=t.y;return e.x=o*c*l+-n*c*u+(h*n-a*o)*c,e.y=i*c*u+-r*c*l+(-h*i+a*r)*c,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,e){const i=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,h=t.ty,c=e.a,l=e.b,u=e.c,d=e.d;return this.a=i*c+r*u,this.b=i*l+r*d,this.c=n*c+o*u,this.d=n*l+o*d,this.tx=a*c+h*u+e.tx,this.ty=a*l+h*d+e.ty,this}setTransform(t,e,i,r,n,o,a,h,c){return this.a=Math.cos(a+c)*n,this.b=Math.sin(a+c)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),c=Math.abs(a+h);return c<1e-5||Math.abs(tn-c)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new R;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return nn.identity()}static get shared(){return rn.identity()}}const rn=new R,nn=new R,Bt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Rt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ft=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Lt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],fs=[],zi=[],Pe=Math.sign;function on(){for(let s=0;s<16;s++){const t=[];fs.push(t);for(let e=0;e<16;e++){const i=Pe(Bt[s]*Bt[e]+Ft[s]*Rt[e]),r=Pe(Rt[s]*Bt[e]+Lt[s]*Rt[e]),n=Pe(Bt[s]*Ft[e]+Ft[s]*Lt[e]),o=Pe(Rt[s]*Ft[e]+Lt[s]*Lt[e]);for(let a=0;a<16;a++)if(Bt[a]===i&&Rt[a]===r&&Ft[a]===n&&Lt[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new R;t.set(Bt[s],Rt[s],Ft[s],Lt[s],0,0),zi.push(t)}}on();const D={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Bt[s],uY:s=>Rt[s],vX:s=>Ft[s],vY:s=>Lt[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>fs[s][t],sub:(s,t)=>fs[s][D.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?D.S:D.N:Math.abs(t)*2<=Math.abs(s)?s>0?D.E:D.W:t>0?s>0?D.SE:D.SW:s>0?D.NE:D.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=zi[D.inv(t)];r.tx=e,r.ty=i,s.append(r)}},Se=[new q,new q,new q,new q];class V{constructor(t=0,e=0,i=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new V(0,0,0,0)}clone(){return new V(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,i){const{width:r,height:n}=this;if(r<=0||n<=0)return!1;const o=this.x,a=this.y,h=o-i/2,c=o+r+i/2,l=a-i/2,u=a+n+i/2,d=o+i/2,f=o+r-i/2,p=a+i/2,g=a+n-i/2;return t>=h&&t<=c&&e>=l&&e<=u&&!(t>d&&t<f&&e>p&&e<g)}intersects(t,e){if(!e){const M=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=M)return!1;const A=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>A}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=Se[0].set(t.left,t.top),h=Se[1].set(t.left,t.bottom),c=Se[2].set(t.right,t.top),l=Se[3].set(t.right,t.bottom);if(c.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(c,c),e.apply(l,l),Math.max(a.x,h.x,c.x,l.x)<=i||Math.min(a.x,h.x,c.x,l.x)>=r||Math.max(a.y,h.y,c.y,l.y)<=n||Math.min(a.y,h.y,c.y,l.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*i+f*n,g=d*r+f*n,m=d*i+f*o,x=d*r+f*o;if(Math.max(p,g,m,x)<=d*a.x+f*a.y||Math.min(p,g,m,x)>=d*l.x+f*l.y)return!1;const y=u*(a.y-c.y),_=u*(c.x-a.x),b=y*i+_*n,C=y*r+_*n,E=y*i+_*o,v=y*r+_*o;return!(Math.max(b,C,E,v)<=y*a.x+_*a.y||Math.min(b,C,E,v)>=y*l.x+_*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}getBounds(t){return t=t||new V,t.copyFrom(this),t}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const qe={default:-1};function $(s="default"){return qe[s]===void 0&&(qe[s]=-1),++qe[s]}const ti={},z="8.0.0";function H(s,t,e=3){if(ti[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),ti[t]=!0}const Hi=()=>{};function $h(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function ei(s){return!(s&s-1)&&!!s}function an(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const si=Object.create(null);function hn(s){const t=si[s];return t===void 0&&(si[s]=$("resource")),t}const Wi=class Yi extends Ct{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,t={...Yi.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){H(z,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=hn(t),this._resourceId}destroy(){this.emit("destroy",this),this.removeAllListeners()}};Wi.defaultOptions={addressMode:"repeat",scaleMode:"linear"};let ln=Wi;const Xi=class Vi extends Ct{constructor(t={}){super(),this.options=t,this.uid=$("textureSource"),this._resourceType="textureSource",this._resourceId=$("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Vi.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new ln(an(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=$("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i=i||this._resolution,t=t||this.width,e=e||this.height;const r=Math.round(t*i),n=Math.round(e*i);return this.width=r/i,this.height=n/i,this._resolution=i,this.pixelWidth===r&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this._resourceId=$("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=ei(this.pixelWidth)&&ei(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Xi.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Pt=Xi;class Fs extends Pt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let i=t.format;i||(e instanceof Float32Array?i="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?i="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?i="rgba16uint":(e instanceof Int8Array,i="bgra8unorm")),super({...t,resource:e,format:i}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Fs.extension=k.TextureSource;const ii=new R;class cn{constructor(t,e){this.mapCoord=new R,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.orig,r=t.trim;r&&(ii.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(ii));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,h=this.clampOffset;return o[0]=(t.frame.x+a+h)/n.width,o[1]=(t.frame.y+a+h)/n.height,o[2]=(t.frame.x+t.frame.width-a+h)/n.width,o[3]=(t.frame.y+t.frame.height-a+h)/n.height,this.uClampOffset[0]=h/n.pixelWidth,this.uClampOffset[1]=h/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}class L extends Ct{constructor({source:t,label:e,frame:i,orig:r,trim:n,defaultAnchor:o,defaultBorders:a,rotate:h}={}){if(super(),this.uid=$("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new V,this.noFrame=!1,this.isTexture=!0,this.label=e,this.source=t?.source??new Pt,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:c,height:l}=this._source;this.frame.width=c,this.frame.height=l}this.orig=r||this.frame,this.trim=n,this.rotate=h??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new cn(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:i,height:r}=this._source,n=e.x/i,o=e.y/r,a=e.width/i,h=e.height/r;let c=this.rotate;if(c){const l=a/2,u=h/2,d=n+l,f=o+u;c=D.add(c,D.NW),t.x0=d+l*D.uX(c),t.y0=f+u*D.uY(c),c=D.add(c,2),t.x1=d+l*D.uX(c),t.y1=f+u*D.uY(c),c=D.add(c,2),t.x2=d+l*D.uX(c),t.y2=f+u*D.uY(c),c=D.add(c,2),t.x3=d+l*D.uX(c),t.y3=f+u*D.uY(c)}else t.x0=n,t.y0=o,t.x1=n+a,t.y1=o,t.x2=n+a,t.y2=o+h,t.x3=n,t.y3=o+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return H(z,"Texture.baseTexture is now Texture.source"),this._source}}L.EMPTY=new L({label:"EMPTY",source:new Pt({label:"EMPTY"})});L.EMPTY.destroy=Hi;L.WHITE=new L({source:new Fs({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});L.WHITE.destroy=Hi;function un(s,t,e,i){const{width:r,height:n}=e.orig,o=e.trim;if(o){const a=o.width,h=o.height;s.minX=o.x-t._x*r-i,s.maxX=s.minX+a,s.minY=o.y-t._y*n-i,s.maxY=s.minY+h}else s.minX=-t._x*r-i,s.maxX=s.minX+r,s.minY=-t._y*n-i,s.maxY=s.minY+n}var dn={grad:.9,turn:360,rad:360/(2*Math.PI)},xt=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},X=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},rt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},$i=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},ri=function(s){return{r:rt(s.r,0,255),g:rt(s.g,0,255),b:rt(s.b,0,255),a:rt(s.a)}},Ze=function(s){return{r:X(s.r),g:X(s.g),b:X(s.b),a:X(s.a,3)}},fn=/^#([0-9a-f]{3,8})$/i,Te=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},ji=function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=Math.max(t,e,i),o=n-Math.min(t,e,i),a=o?n===t?(e-i)/o:n===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},qi=function(s){var t=s.h,e=s.s,i=s.v,r=s.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),o=i*(1-e),a=i*(1-(t-n)*e),h=i*(1-(1-t+n)*e),c=n%6;return{r:255*[i,a,o,o,h,i][c],g:255*[h,i,i,a,o,o][c],b:255*[o,o,h,i,i,a][c],a:r}},ni=function(s){return{h:$i(s.h),s:rt(s.s,0,100),l:rt(s.l,0,100),a:rt(s.a)}},oi=function(s){return{h:X(s.h),s:X(s.s),l:X(s.l),a:X(s.a,3)}},ai=function(s){return qi((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},de=function(s){return{h:(t=ji(s)).h,s:(r=(200-(e=t.s))*(i=t.v)/100)>0&&r<200?e*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,i,r},pn=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,mn=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,gn=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yn=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ps={string:[[function(s){var t=fn.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?X(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?X(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=gn.exec(s)||yn.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:ri({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=pn.exec(s)||mn.exec(s);if(!t)return null;var e,i,r=ni({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(dn[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return ai(r)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,r=s.a,n=r===void 0?1:r;return xt(t)&&xt(e)&&xt(i)?ri({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,r=s.a,n=r===void 0?1:r;if(!xt(t)||!xt(e)||!xt(i))return null;var o=ni({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return ai(o)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,r=s.a,n=r===void 0?1:r;if(!xt(t)||!xt(e)||!xt(i))return null;var o=function(a){return{h:$i(a.h),s:rt(a.s,0,100),v:rt(a.v,0,100),a:rt(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return qi(o)},"hsv"]]},hi=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},_n=function(s){return typeof s=="string"?hi(s.trim(),ps.string):typeof s=="object"&&s!==null?hi(s,ps.object):[null,void 0]},Ke=function(s,t){var e=de(s);return{h:e.h,s:rt(e.s+100*t,0,100),l:e.l,a:e.a}},Qe=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},li=function(s,t){var e=de(s);return{h:e.h,s:e.s,l:rt(e.l+100*t,0,100),a:e.a}},ms=function(){function s(t){this.parsed=_n(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return X(Qe(this.rgba),2)},s.prototype.isDark=function(){return Qe(this.rgba)<.5},s.prototype.isLight=function(){return Qe(this.rgba)>=.5},s.prototype.toHex=function(){return t=Ze(this.rgba),e=t.r,i=t.g,r=t.b,o=(n=t.a)<1?Te(X(255*n)):"","#"+Te(e)+Te(i)+Te(r)+o;var t,e,i,r,n,o},s.prototype.toRgb=function(){return Ze(this.rgba)},s.prototype.toRgbString=function(){return t=Ze(this.rgba),e=t.r,i=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+r+", "+n+")":"rgb("+e+", "+i+", "+r+")";var t,e,i,r,n},s.prototype.toHsl=function(){return oi(de(this.rgba))},s.prototype.toHslString=function(){return t=oi(de(this.rgba)),e=t.h,i=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+r+"%, "+n+")":"hsl("+e+", "+i+"%, "+r+"%)";var t,e,i,r,n},s.prototype.toHsv=function(){return t=ji(this.rgba),{h:X(t.h),s:X(t.s),v:X(t.v),a:X(t.a,3)};var t},s.prototype.invert=function(){return ft({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),ft(Ke(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),ft(Ke(this.rgba,-t))},s.prototype.grayscale=function(){return ft(Ke(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),ft(li(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),ft(li(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?ft({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):X(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=de(this.rgba);return typeof t=="number"?ft({h:t,s:e.s,l:e.l,a:e.a}):X(e.h)},s.prototype.isEqual=function(t){return this.toHex()===ft(t).toHex()},s}(),ft=function(s){return s instanceof ms?s:new ms(s)},ci=[],xn=function(s){s.forEach(function(t){ci.indexOf(t)<0&&(t(ms,ps),ci.push(t))})};function bn(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in e)i[e[r]]=r;var n={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,c=i[this.toHex()];if(c)return c;if(o?.closest){var l=this.toRgb(),u=1/0,d="black";if(!n.length)for(var f in e)n[f]=new s(e[f]).toRgb();for(var p in e){var g=(a=l,h=n[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));g<u&&(u=g,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new s(h).toRgb():null},"name"])}xn([bn]);const Zt=class ce{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof ce)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._normalize(t),this._value=this._cloneSource(t))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,o)=>n===e[o]);if(t!==null&&e!==null){const n=Object.keys(t),o=Object.keys(e);return n.length!==o.length?!1:n.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,i,r]=this._components;return{r:t,g:e,b:i,a:r}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb,t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t=t||this._arrayRgba;const[e,i,r,n]=this._components;return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb;const[e,i,r]=this._components;return t[0]=e,t[1]=i,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,i]=this.toUint8RgbArray();return(i<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,r,n]=ce._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=r,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,r=r*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(r<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,i,r,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,r=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,r,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,r,n=255]=t,e/=255,i/=255,r/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=ce.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=ft(t);o.isValid()&&({r:e,g:i,b:r,a:n}=o.rgba,e/=255,i/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=r,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((r,n)=>{t[n]=Math.min(Math.max(r,e),i)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof ce||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Zt.shared=new Zt;Zt._temp=new Zt;Zt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let st=Zt;const wn={cullArea:null,cullable:!1,cullableChildren:!0};function An(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}const vn={allowChildren:!0,removeChildren(s=0,t){const e=t??this.children.length,i=e-s,r=[];if(i>0&&i<=e){for(let n=e-1;n>=s;n--){const o=this.children[n];o&&(this.renderGroup&&this.renderGroup.removeChild(o),r.push(o),o.parent=null)}An(this.children,s,e);for(let n=0;n<r.length;++n)this.emit("childRemoved",r[n],this,n),r[n].emit("removed",this);return r}else if(i===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||H(z,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const i=s.parent.children.indexOf(s);if(s.parent===this&&i===t)return s;i!==-1&&s.parent.children.splice(i,1)}return t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s.didViewUpdate=!1,s._updateFlags=15,this.renderGroup&&this.renderGroup.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s},removeFromParent(){this.parent?.removeChild(this)}};class Mn{constructor(t){this.pipe="filter",this.priority=1,this.filters=t?.filters,this.filterArea=t?.filterArea}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Ls{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}}class Cn{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Ls(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const lt=new Cn;class Pn{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const i=this._tests[e];if(i.test(t))return lt.get(i.maskClass,t)}return t}returnMaskEffect(t){lt.return(t)}}const gs=new Pn;nt.handleByList(k.MaskEffect,gs._effectClasses);const Sn={_mask:null,_filters:null,effects:[],addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,i)=>e.priority-i.priority),this.renderGroup&&(this.renderGroup.structureDidChange=!0),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),!this.isRenderGroupRoot&&this.renderGroup&&(this.renderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(s){if(this._mask||(this._mask={mask:null,effect:null}),this._mask.mask===s||(this._mask.effect&&(this.removeEffect(this._mask.effect),gs.returnMaskEffect(this._mask.effect),this._mask.effect=null),this._mask.mask=s,s==null))return;const t=gs.getMaskEffect(s);this._mask.effect=t,this.addEffect(t)},get mask(){return this._mask?.mask},set filters(s){!Array.isArray(s)&&s&&(s=[s]),s=s,this._filters||(this._filters={filters:null,effect:null,filterArea:null});const t=s?.length>0,e=this._filters.effect&&!t||!this._filters.effect&&t;if(s=Array.isArray(s)?s.slice(0):s,this._filters.filters=Object.freeze(s),e)if(t){const i=lt.get(Mn);this._filters.effect=i,this.addEffect(i)}else{const i=this._filters.effect;this.removeEffect(i),i.filterArea=null,i.filters=null,this._filters.effect=null,lt.return(i)}t&&(this._filters.effect.filters=s,this._filters.effect.filterArea=this.filterArea)},get filters(){return this._filters?.filters},set filterArea(s){this._filters||(this._filters={filters:null,effect:null,filterArea:null}),this._filters.filterArea=s},get filterArea(){return this._filters?.filterArea}},Tn={label:null,get name(){return H(z,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){H(z,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const r=e[i];if(r.label===s||s instanceof RegExp&&s.test(r.label))return r}if(t)for(let i=0;i<e.length;i++){const n=e[i].getChildByLabel(s,!0);if(n)return n}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let r=0;r<i.length;r++){const n=i[r];(n.label===s||s instanceof RegExp&&s.test(n.label))&&e.push(n)}if(t)for(let r=0;r<i.length;r++)i[r].getChildrenByLabel(s,!0,e);return e}},ui=new R;class vt{constructor(t=1/0,e=1/0,i=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ui,this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new V);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ui,this}set(t,e,i,r){this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}addFrame(t,e,i,r,n){n||(n=this.matrix);const o=n.a,a=n.b,h=n.c,c=n.d,l=n.tx,u=n.ty;let d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=o*t+h*e+l,x=a*t+c*e+u;m<d&&(d=m),x<f&&(f=x),m>p&&(p=m),x>g&&(g=x),m=o*i+h*e+l,x=a*i+c*e+u,m<d&&(d=m),x<f&&(f=x),m>p&&(p=m),x>g&&(g=x),m=o*t+h*r+l,x=a*t+c*r+u,m<d&&(d=m),x<f&&(f=x),m>p&&(p=m),x>g&&(g=x),m=o*i+h*r+l,x=a*i+c*r+u,m<d&&(d=m),x<f&&(f=x),m>p&&(p=m),x>g&&(g=x),this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:h,d:c,tx:l,ty:u}=t;let d=o*e+h*i+l,f=a*e+c*i+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*r+h*i+l,f=a*r+c*i+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+h*n+l,f=a*e+c*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+h*n+l,f=a*r+c*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new vt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i,r){let n=this.minX,o=this.minY,a=this.maxX,h=this.maxY;r||(r=this.matrix);const c=r.a,l=r.b,u=r.c,d=r.d,f=r.tx,p=r.ty;for(let g=e;g<i;g+=2){const m=t[g],x=t[g+1],y=c*m+u*x+f,_=l*m+d*x+p;n=y<n?y:n,o=_<o?_:o,a=y>a?y:a,h=_>h?_:h}this.minX=n,this.minY=o,this.maxX=a,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}const At=new Ls(R),Kt=new Ls(vt);function Zi(s,t,e){e.clear();let i,r;return s.parent?t?i=s.parent.worldTransform:(r=At.get().identity(),i=Ne(s,r)):i=R.IDENTITY,Ki(s,e,i,t),r&&At.return(r),e.isValid||e.set(0,0,0,0),e}function Ki(s,t,e,i){if(!s.visible||!s.measurable)return;let r;i?r=s.worldTransform:(s.updateLocalTransform(),r=At.get(),r.appendFrom(s.localTransform,e));const n=t,o=!!s.effects.length;if(o&&(t=Kt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.addBounds&&(t.matrix=r,s.addBounds(t));for(let a=0;a<s.children.length;a++)Ki(s.children[a],t,r,i)}if(o){for(let a=0;a<s.effects.length;a++)s.effects[a].addBounds?.(t);n.addBounds(t,R.IDENTITY),Kt.return(t)}i||At.return(r)}function Ne(s,t){const e=s.parent;return e&&(Ne(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}let Je=0;const di=500;function j(...s){Je!==di&&(Je++,Je===di?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}function Qi(s,t,e){return t.clear(),e||(e=R.IDENTITY),Ji(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function Ji(s,t,e,i,r){let n;if(r)n=At.get(),n=e.copyTo(n);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const h=s.localTransform;n=At.get(),n.appendFrom(h,e)}const o=t,a=!!s.effects.length;if(a&&(t=Kt.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.renderPipeId&&(t.matrix=n,s.addBounds(t));const h=s.children;for(let c=0;c<h.length;c++)Ji(h[c],t,n,i,!1)}if(a){for(let h=0;h<s.effects.length;h++)s.effects[h].addLocalBounds?.(t,i);o.addBounds(t,R.IDENTITY),Kt.return(t)}At.return(n)}function tr(s,t){const e=s.children;for(let i=0;i<e.length;i++){const r=e[i],n=(r.uid&255)<<24|r._didChangeId&16777215;t.data[t.index]!==n&&(t.data[t.index]=n,t.didChange=!0),t.index++,r.children.length&&tr(r,t)}return t.didChange}const kn=new R,In={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new vt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didChangeId>>12&&(s.didChange=!0,s.data[0]=this._didChangeId>>12),tr(this,s),s.didChange&&Qi(this,s.localBounds,kn),s.localBounds},getBounds(s,t){return Zi(this,s,t||new vt)}},En={_onRender:null,set onRender(s){const t=this.renderGroup;if(!s){this._onRender&&t?.removeOnRender(this),this._onRender=null;return}this._onRender||t?.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Bn={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Rn))}};function Rn(s,t){return s._zIndex-t._zIndex}const Fn={getGlobalPosition(s=new q,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){if(!e){this.updateLocalTransform();const i=Ne(this,new R);return i.append(this.localTransform),i.apply(s,t)}return this.worldTransform.apply(s,t)},toLocal(s,t,e,i){if(t&&(s=t.toGlobal(s,e,i)),!i){this.updateLocalTransform();const r=Ne(this,new R);return r.append(this.localTransform),r.applyInverse(s,e)}return this.worldTransform.applyInverse(s,e)}};class er{constructor(){this.uid=$("instructionSet"),this.instructions=[],this.instructionSize=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class Ln{constructor(t){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this._children=[],this.worldTransform=new R,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new er,this._onRenderContainers=[],this.root=t,this.addChild(t)}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.onChildUpdate(t.root),this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){t.root.didChange&&this._removeChildFromUpdate(t.root);const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t!==this.root&&(this._children.push(t),t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t._onRender&&this.addOnRender(t)),t.renderGroup){if(t.renderGroup.root===t){this.addRenderGroupChild(t.renderGroup);return}}else t.renderGroup=this,t.didChange=!0;const e=t.children;t.isRenderGroupRoot||this.onChildUpdate(t);for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&this.removeOnRender(t),t.renderGroup.root!==t){const i=t.children;for(let r=0;r<i.length;r++)this.removeChild(i[r]);t.didChange&&t.renderGroup._removeChildFromUpdate(t),t.renderGroup=null}else this._removeRenderGroupChild(t.renderGroup);const e=this._children.indexOf(t);e>-1&&this._children.splice(e,1)}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(t.didViewUpdate=!1,this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t))}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}_removeChildFromUpdate(t){const e=this.childrenToUpdate[t.relativeRenderGroupDepth];if(!e)return;const i=e.list.indexOf(t);i>-1&&e.list.splice(i,1),e.index--}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}}function Gn(s,t,e={}){for(const i in t)!e[i]&&t[i]!==void 0&&(s[i]=t[i])}const ts=new et(null),es=new et(null),ss=new et(null,1,1),fi=1,Dn=2,is=4;class K extends Ct{constructor(t={}){super(),this.uid=$("renderable"),this._updateFlags=15,this.isRenderGroupRoot=!1,this.renderGroup=null,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new R,this.relativeGroupTransform=new R,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new et(this,0,0),this._scale=ss,this._pivot=es,this._skew=ts,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didChangeId=0,this._didLocalTransformChangeId=-1,Gn(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach(e=>this.addChild(e)),this.effects=[],t.parent?.addChild(this)}static mixin(t){Object.defineProperties(K.prototype,Object.getOwnPropertyDescriptors(t))}addChild(...t){if(this.allowChildren||H(z,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0];return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e._updateFlags=15,this.renderGroup&&this.renderGroup.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this.children.splice(i,1),this.renderGroup&&this.renderGroup.removeChild(e),e.parent=null,this.emit("childRemoved",e,this,i),e.emit("removed",this)),e}_onUpdate(t){if(t&&t===this._skew&&this._updateSkew(),this._didChangeId++,!this.didChange)if(this.didChange=!0,this.isRenderGroupRoot){const e=this.renderGroup.renderGroupParent;e&&e.onChildUpdate(this)}else this.renderGroup&&this.renderGroup.onChildUpdate(this)}set isRenderGroup(t){if(this.isRenderGroupRoot&&t===!1)throw new Error("[Pixi] cannot undo a render group just yet");t&&this.enableRenderGroup()}get isRenderGroup(){return this.isRenderGroupRoot}enableRenderGroup(){if(this.renderGroup&&this.renderGroup.root===this)return;this.isRenderGroupRoot=!0;const t=this.renderGroup;if(t&&t.removeChild(this),this.renderGroup=new Ln(this),t){for(let e=0;e<t.renderGroupChildren.length;e++){const i=t.renderGroupChildren[e];let r=i.root;for(;r;){if(r===this){this.renderGroup.addRenderGroupChild(i);break}r=r.parent}}t.addRenderGroupChild(this.renderGroup)}this._updateIsSimple(),this.groupTransform=R.IDENTITY}_updateIsSimple(){this.isSimple=!this.isRenderGroupRoot&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new R),this.renderGroup&&(this.isRenderGroupRoot?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this._worldTransform.appendFrom(this.relativeGroupTransform,this.renderGroup.worldTransform)),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*en}set angle(t){this.rotation=t*sn}get pivot(){return this._pivot===es&&(this._pivot=new et(this,0,0)),this._pivot}set pivot(t){this._pivot===es&&(this._pivot=new et(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===ts&&(this._skew=new et(this,0,0)),this._skew}set skew(t){this._skew===ts&&(this._skew=new et(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===ss&&(this._scale=new et(this,1,1)),this._scale}set scale(t){this._scale===ss&&(this._scale=new et(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const i=this.getLocalBounds();let r,n;typeof t!="object"?(r=t,n=e??t):(r=t.width,n=t.height??t.width),r!==void 0&&this._setWidth(r,i.width),n!==void 0&&this._setHeight(n,i.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){if((this._didLocalTransformChangeId&15)===this._didChangeId)return;this._didLocalTransformChangeId=this._didChangeId;const t=this.localTransform,e=this._scale,i=this._pivot,r=this._position,n=e._x,o=e._y,a=i._x,h=i._y;t.a=this._cx*n,t.b=this._sx*n,t.c=this._cy*o,t.d=this._sy*o,t.tx=r._x-(a*t.a+h*t.c),t.ty=r._y-(a*t.b+h*t.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=fi,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const i=st.shared.setValue(t??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=fi,this._onUpdate())}get tint(){const t=this.localColor;return((t&255)<<16)+(t&65280)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=Dn,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?1:0;(this.localDisplayStatus&2)>>1!==e&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=is,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?1:0;(this.localDisplayStatus&4)>>2!==e&&(this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._updateFlags|=is,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=is,this.localDisplayStatus^=1,this.renderGroup&&!this.isRenderGroupRoot&&(this.renderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;this.destroyed=!0,this.removeFromParent(),this.parent=null,this._mask=null,this._filters=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners();const e=typeof t=="boolean"?t:t?.children,i=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<i.length;++r)i[r].destroy(t)}}K.mixin(vn);K.mixin(Fn);K.mixin(En);K.mixin(In);K.mixin(Sn);K.mixin(Tn);K.mixin(Bn);K.mixin(wn);class ot extends K{constructor(t=L.EMPTY){t instanceof L&&(t={texture:t});const{texture:e,anchor:i,roundPixels:r,width:n,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._didSpriteUpdate=!1,this._bounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._boundsDirty=!0,this._sourceBoundsDirty=!0,this._roundPixels=0,this._anchor=new et({_onUpdate:()=>{this.onViewUpdate()}}),i&&(this.anchor=i),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,n&&(this.width=n),o&&(this.height=o)}static from(t,e=!1){return t instanceof L?new ot(t):new ot(L.from(t,e))}set texture(t){t||(t=L.EMPTY),this._texture!==t&&(this._texture=t,this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(t){const e=this.sourceBounds;return t.x>=e.maxX&&t.x<=e.minX&&t.y>=e.maxY&&t.y<=e.minY}addBounds(t){const e=this._texture.trim?this.sourceBounds:this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}onViewUpdate(){this._didChangeId+=4096,this._didSpriteUpdate=!0,this._sourceBoundsDirty=this._boundsDirty=!0,!this.didViewUpdate&&(this.didViewUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}_updateBounds(){un(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const t=this._anchor,e=this._texture,i=this._sourceBounds,{width:r,height:n}=e.orig;i.maxX=-t._x*r,i.minX=i.maxX+r,i.maxY=-t._y*n,i.minY=i.maxY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t?.texture){const i=typeof t=="boolean"?t:t?.textureSource;this._texture.destroy(i)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width)}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){let i,r;typeof t!="object"?(i=t,r=e??t):(i=t.width,r=t.height??t.width),i!==void 0&&this._setWidth(i,this._texture.orig.width),r!==void 0&&this._setHeight(r,this._texture.orig.height)}}const On=new vt;function sr(s,t,e){const i=On;s.measurable=!0,Zi(s,e,i),t.addBoundsMask(i),s.measurable=!1}function ir(s,t,e){const i=Kt.get();s.measurable=!0;const r=At.get().identity(),n=rr(s,e,r);Qi(s,i,n),s.measurable=!1,t.addBoundsMask(i),At.return(r),Kt.return(i)}function rr(s,t,e){return s?(s!==t&&(rr(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(j("Mask bounds, renderable is not inside the root container"),e)}class nr{constructor(t){this.priority=0,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof ot),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){sr(this.mask,t,e)}addLocalBounds(t,e){ir(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof ot}}nr.extension=k.MaskEffect;class or{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}or.extension=k.MaskEffect;class ar{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){sr(this.mask,t,e)}addLocalBounds(t,e){ir(this.mask,t,e)}containsPoint(t,e){const i=this.mask;return e(i,t)}destroy(){this.reset()}static test(t){return t instanceof K}}ar.extension=k.MaskEffect;const Un={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getWebGL2RenderingContext:()=>WebGL2RenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let pi=Un;const J={get(){return pi},set(s){pi=s}};class hr extends Pt{constructor(t){t.resource||(t.resource=J.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity;const e=t.resource;(this.pixelWidth!==e.width||this.pixelWidth!==e.height)&&this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,i=this._resolution){const r=super.resize(t,e,i);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}}hr.extension=k.TextureSource;class be extends Pt{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=J.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0),t.resource=e,j("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap}}be.extension=k.TextureSource;var ys=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(ys||{});class rs{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=i,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const lr=class tt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new rs(null,null,1/0),this.deltaMS=1/tt.targetFPMS,this.elapsedMS=1/tt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=ys.NORMAL){return this._addListener(new rs(t,e,i))}addOnce(t,e,i=ys.NORMAL){return this._addListener(new rs(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*tt.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,tt.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!tt._shared){const t=tt._shared=new tt;t.autoStart=!0,t._protected=!0}return tt._shared}static get system(){if(!tt._system){const t=tt._system=new tt;t.autoStart=!0,t._protected=!0}return tt._system}};lr.targetFPMS=.06;let ke=lr,ns;async function cr(){return ns??(ns=(async()=>{const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return"premultiply-alpha-on-upload";const i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(r),t.deleteTexture(i),t.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),ns}const Ye=class ur extends Pt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...ur.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=ke.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await cr(),this._load=new Promise((i,r)=>{this.isValid?i(this):(this._resolve=i,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ke.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ke.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ke.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||globalThis.VideoFrame&&t instanceof VideoFrame}};Ye.extension=k.TextureSource;Ye.defaultOptions={...Pt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Ye.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let De=Ye;const ct=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(i=>typeof i=="string"||e?t(i):i):s);class Nn{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||j(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=ct(t);let r;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.test(e)){r=c.getCacheableAssets(i,e);break}}const n=new Map(Object.entries(r||{}));r||i.forEach(h=>{n.set(h,e)});const o=[...n.keys()],a={cacheKeys:o,keys:i};i.forEach(h=>{this._cacheMap.set(h,a)}),o.forEach(h=>{const c=r?r[h]:e;this._cache.has(h)&&this._cache.get(h)!==c&&j("[Cache] already has key:",h),this._cache.set(h,n.get(h))})}remove(t){if(!this._cacheMap.has(t)){j(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Z=new Nn,_s=[];nt.handleByList(k.TextureSource,_s);function zn(s={}){const t=s&&s.resource,e=t?s.resource:s,i=t?s:{resource:s};for(let r=0;r<_s.length;r++){const n=_s[r];if(n.test(e))return new n(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function Hn(s={},t=!1){const e=s&&s.resource,i=e?s.resource:s,r=e?s:{resource:s};if(!t&&Z.has(i))return Z.get(i);const n=new L({source:zn(r)});return n.on("destroy",()=>{Z.has(i)&&Z.remove(i)}),t||Z.set(i,n),n}function Wn(s,t=!1){return typeof s=="string"?Z.get(s):s instanceof Pt?new L({source:s}):Hn(s,t)}L.from=Wn;nt.add(nr,or,ar,De,be,hr,Fs);var Ut=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(Ut||{});function ht(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function oe(s){return s.split("?")[0].split("#")[0]}function Yn(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Xn(s,t,e){return s.replace(new RegExp(Yn(t),"g"),e)}function Vn(s,t){let e="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const yt={toPosix(s){return Xn(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){ht(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(ht(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const i=oe(this.toPosix(t??J.get().getBaseUrl())),r=oe(this.toPosix(e??this.rootname(i)));return s=this.toPosix(s),s.startsWith("/")?yt.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(ht(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Vn(s,!1),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return ht(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(ht(i),i.length>0)if(t===void 0)t=i;else{const r=s[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(ht(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,r=!0;const n=this.getProtocol(s),o=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(o)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){ht(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){ht(s),t&&ht(t),s=oe(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){const h=s.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){ht(s),s=oe(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){ht(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=oe(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let r;t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,c=s.length-1,l=0;for(;c>=r;--c){if(e=s.charCodeAt(c),e===47){if(!h){o=c+1;break}continue}a===-1&&(h=!1,a=c+1),e===46?n===-1?n=c:l!==1&&(l=1):n!==-1&&(l=-1)}return n===-1||a===-1||l===0||l===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&i?(t.name=s.slice(1,n),t.base=s.slice(1,a)):(t.name=s.slice(o,n),t.base=s.slice(o,a)),t.ext=s.slice(n,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function dr(s,t,e,i,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?dr(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function $n(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),dr(s,r,0,e,i)}else i.push(s);return i}const ze=s=>!Array.isArray(s);class Jt{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,src:i}=t;return ct(e||i,n=>typeof n=="string"?n:Array.isArray(n)?n.map(o=>o?.src??o):n?.src?n.src:n,!0)}addManifest(t){this._manifest&&j("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([n,o])=>typeof o=="string"||Array.isArray(o)?{alias:n,src:o}:{alias:n,...o})),r.forEach(n=>{const o=n.src,a=n.alias;let h;if(typeof a=="string"){const c=this._createBundleAssetId(t,a);i.push(c),h=[a,c]}else{const c=a.map(l=>this._createBundleAssetId(t,l));i.push(...c),h=[...a,...c]}this.add({...n,alias:h,src:o})}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let i;i=n=>{this.hasKey(n)&&j(`[Resolver] already has key: ${n} overwriting`)},ct(e).forEach(n=>{const{src:o}=n;let{data:a,format:h,loadParser:c}=n;const l=ct(o).map(f=>typeof f=="string"?$n(f):Array.isArray(f)?f:[f]),u=this.getAlias(n);Array.isArray(u)?u.forEach(i):i(u);const d=[];l.forEach(f=>{f.forEach(p=>{let g={};if(typeof p!="object"){g.src=p;for(let m=0;m<this._parsers.length;m++){const x=this._parsers[m];if(x.test(p)){g=x.parse(p);break}}}else a=p.data??a,h=p.format??h,c=p.loadParser??c,g={...g,...p};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:u,data:a,format:h,loadParser:c}),d.push(g)})}),u.forEach(f=>{this._assetMap[f]=d})})}resolveBundle(t){const e=ze(t);t=ct(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const c=o[h];a[this._extractAssetIdFromBundle(r,h)]=c}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const r in e)i[r]=e[r].src;return i}return e.src}resolve(t){const e=ze(t);t=ct(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n);o?.priority.forEach(a=>{o.params[a].forEach(h=>{const c=n.filter(l=>l[a]?l[a]===h:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:i,data:r,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=yt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.format??jn(t.src),t}}Jt.RETINA_PREFIX=/@([0-9\.]+)x/;function jn(s){return s.split(".").pop().split("?").shift().split("#").shift()}const mi=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},fr=class ue{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof L?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const i=parseFloat(e.meta.scale);i?(this.resolution=i,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ue.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=ue.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const r=this._frameKeys[e],n=this._frames[r],o=n.frame;if(o){let a=null,h=null;const c=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,l=new V(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);n.rotated?a=new V(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new V(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new V(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new L({source:this.textureSource,frame:a,orig:l,trim:h,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const r=t[e][i];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ue.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ue.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};fr.BATCH_SIZE=1e3;let gi=fr;const qn=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function pr(s,t,e){const i={};if(s.forEach(r=>{i[r]=t}),Object.keys(t.textures).forEach(r=>{i[r]=t.textures[r]}),!e){const r=yt.dirname(s[0]);t.linkedSheets.forEach((n,o)=>{const a=pr([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(i,a)})}return i}const Zn={extension:k.Asset,cache:{test:s=>s instanceof gi,getCacheableAssets:(s,t)=>pr(s,t,!1)},resolver:{test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),r=e.pop();return i==="json"&&qn.includes(r)},parse:s=>{const t=s.split(".");return{resolution:parseFloat(Jt.RETINA_PREFIX.exec(s)?.[1]??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:k.LoadParser,priority:Ut.Normal},async testParse(s,t){return yt.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){const{texture:i,imageFilename:r}=t?.data??{};let n=yt.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let o;if(i instanceof L)o=i;else{const c=mi(n+(r??s.meta.image),t.src);o=(await e.load([c]))[c]}const a=new gi(o.source,s);await a.parse();const h=s?.meta?.related_multi_packs;if(Array.isArray(h)){const c=[];for(const u of h){if(typeof u!="string")continue;let d=n+u;t.data?.ignoreMultiPack||(d=mi(d,t.src),c.push(e.load({src:d,data:{ignoreMultiPack:!0}})))}const l=await Promise.all(c);a.linkedSheets=l,l.forEach(u=>{u.linkedSheets=[a].concat(a.linkedSheets.filter(d=>d!==u))})}return a},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};nt.add(Zn);class Kn{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const i in t){const r=t[i];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i]._resourceId;this._key=t.join("|")}setResource(t,e){const i=this.resources[e];t!==i&&(i&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const i in e)e[i]._touched=t}destroy(){const t=this.resources;for(const e in t)t[e].off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(){this._dirty=!0,this._updateKey()}}const xs=[];nt.handleByNamedList(k.Environment,xs);async function Qn(s){if(s)for(let t=0;t<xs.length;t++){const e=xs[t];if(e.value.test()){await e.value.load();return}}}let ae;function Jn(){if(typeof ae=="boolean")return ae;try{ae=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ae=!1}return ae}var Gs={exports:{}};Gs.exports=Xe;Gs.exports.default=Xe;function Xe(s,t,e){e=e||2;var i=t&&t.length,r=i?t[0]*e:s.length,n=mr(s,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,c,l,u,d,f;if(i&&(n=ro(s,t,n,e)),s.length>80*e){a=c=s[0],h=l=s[1];for(var p=e;p<r;p+=e)u=s[p],d=s[p+1],u<a&&(a=u),d<h&&(h=d),u>c&&(c=u),d>l&&(l=d);f=Math.max(c-a,l-h),f=f!==0?32767/f:0}return ge(n,o,e,a,h,f,0),o}function mr(s,t,e,i,r){var n,o;if(r===As(s,t,e,i)>0)for(n=t;n<e;n+=i)o=yi(n,s[n],s[n+1],o);else for(n=e-i;n>=t;n-=i)o=yi(n,s[n],s[n+1],o);return o&&Ve(o,o.next)&&(_e(o),o=o.next),o}function Dt(s,t){if(!s)return s;t||(t=s);var e=s,i;do if(i=!1,!e.steiner&&(Ve(e,e.next)||O(e.prev,e,e.next)===0)){if(_e(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function ge(s,t,e,i,r,n,o){if(s){!o&&n&&lo(s,i,r,n);for(var a=s,h,c;s.prev!==s.next;){if(h=s.prev,c=s.next,n?eo(s,i,r,n):to(s)){t.push(h.i/e|0),t.push(s.i/e|0),t.push(c.i/e|0),_e(s),s=c.next,a=c.next;continue}if(s=c,s===a){o?o===1?(s=so(Dt(s),t,e),ge(s,t,e,i,r,n,2)):o===2&&io(s,t,e,i,r,n):ge(Dt(s),t,e,i,r,n,1);break}}}}function to(s){var t=s.prev,e=s,i=s.next;if(O(t,e,i)>=0)return!1;for(var r=t.x,n=e.x,o=i.x,a=t.y,h=e.y,c=i.y,l=r<n?r<o?r:o:n<o?n:o,u=a<h?a<c?a:c:h<c?h:c,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>c?a:c:h>c?h:c,p=i.next;p!==t;){if(p.x>=l&&p.x<=d&&p.y>=u&&p.y<=f&&Vt(r,a,n,h,o,c,p.x,p.y)&&O(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function eo(s,t,e,i){var r=s.prev,n=s,o=s.next;if(O(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,c=o.x,l=r.y,u=n.y,d=o.y,f=a<h?a<c?a:c:h<c?h:c,p=l<u?l<d?l:d:u<d?u:d,g=a>h?a>c?a:c:h>c?h:c,m=l>u?l>d?l:d:u>d?u:d,x=bs(f,p,t,e,i),y=bs(g,m,t,e,i),_=s.prevZ,b=s.nextZ;_&&_.z>=x&&b&&b.z<=y;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Vt(a,l,h,u,c,d,_.x,_.y)&&O(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Vt(a,l,h,u,c,d,b.x,b.y)&&O(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=x;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Vt(a,l,h,u,c,d,_.x,_.y)&&O(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Vt(a,l,h,u,c,d,b.x,b.y)&&O(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function so(s,t,e){var i=s;do{var r=i.prev,n=i.next.next;!Ve(r,n)&&gr(r,i,i.next,n)&&ye(r,n)&&ye(n,r)&&(t.push(r.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),_e(i),_e(i.next),i=s=n),i=i.next}while(i!==s);return Dt(i)}function io(s,t,e,i,r,n){var o=s;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&fo(o,a)){var h=yr(o,a);o=Dt(o,o.next),h=Dt(h,h.next),ge(o,t,e,i,r,n,0),ge(h,t,e,i,r,n,0);return}a=a.next}o=o.next}while(o!==s)}function ro(s,t,e,i){var r=[],n,o,a,h,c;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:s.length,c=mr(s,a,h,i,!1),c===c.next&&(c.steiner=!0),r.push(uo(c));for(r.sort(no),n=0;n<r.length;n++)e=oo(r[n],e);return e}function no(s,t){return s.x-t.x}function oo(s,t){var e=ao(s,t);if(!e)return t;var i=yr(e,s);return Dt(i,i.next),Dt(e,e.next)}function ao(s,t){var e=t,i=s.x,r=s.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,c=o.x,l=o.y,u=1/0,d;e=o;do i>=e.x&&e.x>=c&&i!==e.x&&Vt(r<l?i:n,r,c,l,r<l?n:i,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(i-e.x),ye(e,s)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&ho(o,e)))&&(o=e,u=d)),e=e.next;while(e!==h);return o}function ho(s,t){return O(s.prev,s,t.prev)<0&&O(t.next,s,s.next)<0}function lo(s,t,e,i){var r=s;do r.z===0&&(r.z=bs(r.x,r.y,t,e,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,co(r)}function co(s){var t,e,i,r,n,o,a,h,c=1;do{for(e=s,s=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<c&&(a++,i=i.nextZ,!!i);t++);for(h=c;a>0||h>0&&i;)a!==0&&(h===0||!i||e.z<=i.z)?(r=e,e=e.nextZ,a--):(r=i,i=i.nextZ,h--),n?n.nextZ=r:s=r,r.prevZ=n,n=r;e=i}n.nextZ=null,c*=2}while(o>1);return s}function bs(s,t,e,i,r){return s=(s-e)*r|0,t=(t-i)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function uo(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Vt(s,t,e,i,r,n,o,a){return(r-o)*(t-a)>=(s-o)*(n-a)&&(s-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(i-a)}function fo(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!po(s,t)&&(ye(s,t)&&ye(t,s)&&mo(s,t)&&(O(s.prev,s,t.prev)||O(s,t.prev,t))||Ve(s,t)&&O(s.prev,s,s.next)>0&&O(t.prev,t,t.next)>0)}function O(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function Ve(s,t){return s.x===t.x&&s.y===t.y}function gr(s,t,e,i){var r=Ee(O(s,t,e)),n=Ee(O(s,t,i)),o=Ee(O(e,i,s)),a=Ee(O(e,i,t));return!!(r!==n&&o!==a||r===0&&Ie(s,e,t)||n===0&&Ie(s,i,t)||o===0&&Ie(e,s,i)||a===0&&Ie(e,t,i))}function Ie(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Ee(s){return s>0?1:s<0?-1:0}function po(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&gr(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function ye(s,t){return O(s.prev,s,s.next)<0?O(s,t,s.next)>=0&&O(s,s.prev,t)>=0:O(s,t,s.prev)<0||O(s,s.next,t)<0}function mo(s,t){var e=s,i=!1,r=(s.x+t.x)/2,n=(s.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function yr(s,t){var e=new ws(s.i,s.x,s.y),i=new ws(t.i,t.x,t.y),r=s.next,n=t.prev;return s.next=t,t.prev=s,e.next=r,r.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function yi(s,t,e,i){var r=new ws(s,t,e);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function _e(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function ws(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Xe.deviation=function(s,t,e,i){var r=t&&t.length,n=r?t[0]*e:s.length,o=Math.abs(As(s,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var c=t[a]*e,l=a<h-1?t[a+1]*e:s.length;o-=Math.abs(As(s,c,l,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;u+=Math.abs((s[d]-s[p])*(s[f+1]-s[d+1])-(s[d]-s[f])*(s[p+1]-s[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function As(s,t,e,i){for(var r=0,n=t,o=e-i;n<e;n+=i)r+=(s[o]-s[n])*(s[n+1]+s[o+1]),o=n;return r}Xe.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,r=0;r<s.length;r++){for(var n=0;n<s[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(s[r][n][o]);r>0&&(i+=s[r-1].length,e.holes.push(i))}return e};var go=Gs.exports;const yo=Rs(go);var _r=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(_r||{});class _o{constructor(t){this.items=[],this._name=t}emit(t,e,i,r,n,o,a,h){const{name:c,items:l}=this;for(let u=0,d=l.length;u<d;u++)l[u][c](t,e,i,r,n,o,a,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const xo=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],xr=class br extends Ct{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name;const e=[...xo,...t.runners??[]];this._addRunners(...e),this._addSystems(t.systems),this._addPipes(t.renderPipes,t.renderPipeAdaptors),this._unsafeEvalCheck()}async init(t={}){for(const e in this._systemsHash)t={...this._systemsHash[e].constructor.defaultOptions,...t};t={...br.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let e=0;e<this.runners.init.items.length;e++)await this.runners.init.items[e].init(t);this._initOptions=t}render(t,e){let i=t;if(i instanceof K&&(i={container:i},e&&(H(z,"passing a second argument is deprecated, please use render options instead"),i.target=e.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor=this.background.colorRgba),i.clearColor){const r=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=r?i.clearColor:st.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i)}resize(t,e,i){this.view.resize(t,e,i),this.emit("resize",this.view.screen.width,this.view.screen.height)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=_r.ALL);const{clear:i,clearColor:r,target:n}=t;st.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(n,i,st.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new _o(e)})}_addSystems(t){let e;for(e in t){const i=t[e];this._addSystem(i.value,i.name)}}_addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const r in this.runners)this.runners[r].add(i);return this}_addPipes(t,e){const i=e.reduce((r,n)=>(r[n.name]=n.value,r),{});t.forEach(r=>{const n=r.value,o=r.name,a=i[o];this.renderPipes[o]=new n(this,a?new a:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Jn())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};xr.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let wr=xr,Be;function bo(s){return Be!==void 0||(Be=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:s??wr.defaultOptions.failIfMajorPerformanceCaveat};try{if(!J.get().getWebGLRenderingContext())return!1;let i=J.get().createCanvas().getContext("webgl",t);const r=!!i?.getContextAttributes()?.stencil;if(i){const n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch{return!1}})()),Be}let Re;async function wo(s={}){return Re!==void 0||(Re=await(async()=>{if(!J.get().getNavigator().gpu)return!1;try{return await(await navigator.gpu.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Re}const _i=["webgpu","webgl","canvas"];async function Ao(s){let t=[];s.preference?(t.push(s.preference),_i.forEach(n=>{n!==s.preference&&t.push(n)})):t=_i.slice();let e;await Qn(s.manageImports??!0);let i={};for(let n=0;n<t.length;n++){const o=t[n];if(o==="webgpu"&&await wo()){const{WebGPURenderer:a}=await Ue(()=>import("./WebGPURenderer-D7l_qpV8.js"),__vite__mapDeps([6,2,7,3,5]));e=a,i={...s,...s.webgpu};break}else if(o==="webgl"&&bo(s.failIfMajorPerformanceCaveat??wr.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ue(()=>import("./WebGLRenderer-Bh0isDr3.js"),__vite__mapDeps([8,2,4,7,5]));e=a,i={...s,...s.webgl};break}else if(o==="canvas"){i={...s};break}}delete i.webgpu,delete i.webgl;const r=new e;return await r.init(i),r}const Ar=class vs{constructor(...t){this.stage=new K,t[0]!==void 0&&H(z,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Ao(t),vs._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return H(z,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const i=vs._plugins.slice(0);i.reverse(),i.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Ar._plugins=[];let vr=Ar;nt.handleByList(k.Application,vr._plugins);class vo{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Mo={extension:k.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof L),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((r,n)=>{e[i+(n===0?"":n+1)]=r})}),e}};async function Mr(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Co={extension:{type:k.DetectionParser,priority:1},test:async()=>Mr("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},xi=["png","jpg","jpeg"],Po={extension:{type:k.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...xi],remove:async s=>s.filter(t=>!xi.includes(t))},So="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ds(s){return So?!1:document.createElement("video").canPlayType(s)!==""}const To={extension:{type:k.DetectionParser,priority:0},test:async()=>Ds("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},ko={extension:{type:k.DetectionParser,priority:0},test:async()=>Ds("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},Io={extension:{type:k.DetectionParser,priority:0},test:async()=>Ds("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},Eo={extension:{type:k.DetectionParser,priority:0},test:async()=>Mr("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};class Bo{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||j(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(t,e,this)){n=a;break}}if(!n)return j(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),i.parser=n;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(r,e,this)&&(r=await a.parse(r,e,this)||r,i.parser=a)}return r})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const r={},n=ze(t),o=ct(t,c=>({alias:[c],src:c})),a=o.length,h=o.map(async c=>{const l=yt.toAbsolute(c.src);if(!r[c.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,c)),r[c.src]=await this.promiseCache[l].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[l],delete r[c.src],new Error(`[Loader.load] Failed to load ${l}.
${u}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const i=ct(t,r=>({alias:[r],src:r})).map(async r=>{const n=yt.toAbsolute(r.src),o=this.promiseCache[n];if(o){const a=await o.promise;delete this.promiseCache[n],await o.parser?.unload?.(a,r,this)}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&j(`[Assets] loadParser name conflict "${e.name}"`):j("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function te(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function ee(s,t){const e=s.split("?")[0],i=yt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const Ro=".json",Fo="application/json",Lo={extension:{type:k.LoadParser,priority:Ut.Low},name:"loadJson",test(s){return te(s,Fo)||ee(s,Ro)},async load(s){return await(await J.get().fetch(s)).json()}},Go=".txt",Do="text/plain",Oo={name:"loadTxt",extension:{type:k.LoadParser,priority:Ut.Low},test(s){return te(s,Do)||ee(s,Go)},async load(s){return await(await J.get().fetch(s)).text()}},Uo=["normal","bold","100","200","300","400","500","600","700","800","900"],No=[".ttf",".otf",".woff",".woff2"],zo=["font/ttf","font/otf","font/woff","font/woff2"],Ho=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Wo(s){const t=yt.extname(s),r=yt.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let n=r.length>0;for(const a of r)if(!a.match(Ho)){n=!1;break}let o=r.join(" ");return n||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const Yo=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Xo(s){return Yo.test(s)?s:encodeURI(s)}const Vo={extension:{type:k.LoadParser,priority:Ut.Low},name:"loadWebFont",test(s){return te(s,zo)||ee(s,No)},async load(s,t){const e=J.get().getFontFaceSet();if(e){const i=[],r=t.data?.family??Wo(s),n=t.data?.weights?.filter(a=>Uo.includes(a))??["normal"],o=t.data??{};for(let a=0;a<n.length;a++){const h=n[a],c=new FontFace(r,`url(${Xo(s)})`,{...o,weight:h});await c.load(),e.add(c),i.push(c)}return Z.set(`${r}-and-url`,{url:s,fontFaces:i}),i.length===1?i[0]:i}return j("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>{Z.remove(t.family),J.get().getFontFaceSet().delete(t)})}};var $o=qo,os={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},jo=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function qo(s){var t=[];return s.replace(jo,function(e,i,r){var n=i.toLowerCase();for(r=Ko(r),n=="m"&&r.length>2&&(t.push([i].concat(r.splice(0,2))),n="l",i=i=="m"?"l":"L");;){if(r.length==os[n])return r.unshift(i),t.push(r);if(r.length<os[n])throw new Error("malformed path data");t.push([i].concat(r.splice(0,os[n])))}}),t}var Zo=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function Ko(s){var t=s.match(Zo);return t?t.map(Number):[]}const Qo=Rs($o);function Jo(s,t){const e=Qo(s),i=[];let r=null,n=0,o=0;for(let a=0;a<e.length;a++){const h=e[a],c=h[0],l=h;switch(c){case"M":n=l[1],o=l[2],t.moveTo(n,o);break;case"m":n+=l[1],o+=l[2],t.moveTo(n,o);break;case"H":n=l[1],t.lineTo(n,o);break;case"h":n+=l[1],t.lineTo(n,o);break;case"V":o=l[1],t.lineTo(n,o);break;case"v":o+=l[1],t.lineTo(n,o);break;case"L":n=l[1],o=l[2],t.lineTo(n,o);break;case"l":n+=l[1],o+=l[2],t.lineTo(n,o);break;case"C":n=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],n,o);break;case"c":t.bezierCurveTo(n+l[1],o+l[2],n+l[3],o+l[4],n+l[5],o+l[6]),n+=l[5],o+=l[6];break;case"S":n=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],n,o);break;case"s":t.bezierCurveToShort(n+l[1],o+l[2],n+l[3],o+l[4]),n+=l[3],o+=l[4];break;case"Q":n=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],n,o);break;case"q":t.quadraticCurveTo(n+l[1],o+l[2],n+l[3],o+l[4]),n+=l[3],o+=l[4];break;case"T":n=l[1],o=l[2],t.quadraticCurveToShort(n,o);break;case"t":n+=l[1],o+=l[2],t.quadraticCurveToShort(n,o);break;case"A":n=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,o);break;case"a":n+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,o);break;case"Z":case"z":t.closePath(),i.length>0&&(r=i.pop(),r?(n=r.startX,o=r.startY):(n=0,o=0)),r=null;break;default:j(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&r===null&&(r={startX:n,startY:o},i.push(r))}return t}class Os{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new Os(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}strokeContains(t,e,i){if(this.radius===0)return!1;const r=this.x-t,n=this.y-e,o=this.radius,a=i/2,h=Math.sqrt(r*r+n*n);return h<o+a&&h>o-a}getBounds(t){return t=t||new V,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Us{constructor(t=0,e=0,i=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=r}clone(){return new Us(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return i*=i,r*=r,i+r<=1}strokeContains(t,e,i){const{halfWidth:r,halfHeight:n}=this;if(r<=0||n<=0)return!1;const o=i/2,a=r-o,h=n-o,c=r+o,l=n+o,u=t-this.x,d=e-this.y,f=u*u/(a*a)+d*d/(h*h),p=u*u/(c*c)+d*d/(l*l);return f>1&&p<=1}getBounds(){return new V(this.x-this.halfWidth,this.y-this.halfHeight,this.halfWidth*2,this.halfHeight*2)}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function ta(s,t,e,i,r,n){const o=s-e,a=t-i,h=r-e,c=n-i,l=o*h+a*c,u=h*h+c*c;let d=-1;u!==0&&(d=l/u);let f,p;d<0?(f=e,p=i):d>1?(f=r,p=n):(f=e+d*h,p=i+d*c);const g=s-f,m=t-p;return g*g+m*m}class fe{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new fe(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],c=this.points[o*2],l=this.points[o*2+1];h>e!=l>e&&t<(c-a)*((e-h)/(l-h))+a&&(i=!i)}return i}strokeContains(t,e,i){const r=i/2,n=r*r,{points:o}=this;for(let a=0;a<o.length;a+=2){const h=o[a],c=o[a+1],l=o[(a+2)%o.length],u=o[(a+3)%o.length];if(ta(t,e,h,c,l,u)<=n)return!0}return!1}getBounds(t){t=t||new V;const e=this.points;let i=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const c=e[a],l=e[a+1];i=c<i?c:i,r=c>r?c:r,n=l<n?l:n,o=l>o?l:o}return t.x=i,t.width=r-i,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const Fe=(s,t,e,i,r,n)=>{const o=s-e,a=t-i,h=Math.sqrt(o*o+a*a);return h>=r-n&&h<=r+n};class Ns{constructor(t=0,e=0,i=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n}getBounds(t){return t=t||new V,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Ns(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=e-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}strokeContains(t,e,i){const{x:r,y:n,width:o,height:a,radius:h}=this,c=i/2,l=r+h,u=n+h,d=o-h*2,f=a-h*2,p=r+o,g=n+a;return(t>=r-c&&t<=r+c||t>=p-c&&t<=p+c)&&e>=u&&e<=u+f||(e>=n-c&&e<=n+c||e>=g-c&&e<=g+c)&&t>=l&&t<=l+d?!0:t<l&&e<u&&Fe(t,e,l,u,h,c)||t>p-h&&e<u&&Fe(t,e,p-h,u,h,c)||t>p-h&&e>g-h&&Fe(t,e,p-h,g-h,h,c)||t<l&&e>g-h&&Fe(t,e,l,g-h,h,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var Q=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(Q||{});class xe extends Ct{constructor(t){let{data:e,size:i}=t;const{usage:r,label:n,shrinkToFit:o}=t;super(),this.uid=$("buffer"),this._resourceType="buffer",this._resourceId=$("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,e instanceof Array&&(e=new Float32Array(e)),this._data=e,i=i??e?.byteLength;const a=!!e;this.descriptor={size:i,usage:r,mappedAtCreation:a,label:n},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get static(){return!!(this.descriptor.usage&Q.STATIC)}set static(t){t?this.descriptor.usage|=Q.STATIC:this.descriptor.usage&=~Q.STATIC}setDataWithSize(t,e,i){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){i&&this.emit("update",this);return}const r=this._data;if(this._data=t,r.length!==t.length){!this.shrinkToFit&&t.byteLength<r.byteLength?i&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=$("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.emit("destroy",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Cr(s,t){if(!(s instanceof xe)){let e=t?Q.INDEX:Q.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=Q.INDEX|Q.COPY_DST):(s=new Float32Array(s),e=Q.VERTEX|Q.COPY_DST)),s=new xe({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function ea(s,t,e){const i=s.getAttribute(t);if(!i)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=i.buffer.data;let n=1/0,o=1/0,a=-1/0,h=-1/0;const c=r.BYTES_PER_ELEMENT,l=(i.offset||0)/c,u=(i.stride||2*4)/c;for(let d=l;d<r.length;d+=u){const f=r[d],p=r[d+1];f>a&&(a=f),p>h&&(h=p),f<n&&(n=f),p<o&&(o=p)}return e.minX=n,e.minY=o,e.maxX=a,e.maxY=h,e}function sa(s){return(s instanceof xe||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=Cr(s.buffer,!1),s}class ia extends Ct{constructor(t){const{attributes:e,indexBuffer:i,topology:r}=t;super(),this.uid=$("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new vt,this._boundsDirty=!0,this.attributes=e,this.buffers=[],this.instanceCount=t.instanceCount||1;for(const n in e){const o=e[n]=sa(e[n]);this.buffers.indexOf(o.buffer)===-1&&(this.buffers.push(o.buffer),o.buffer.on("update",this.onBufferUpdate,this),o.buffer.on("change",this.onBufferUpdate,this))}i&&(this.indexBuffer=Cr(i,!0),this.buffers.push(this.indexBuffer)),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,ea(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const ra=new Float32Array(1),na=new Uint32Array(1);class oa extends ia{constructor(){const e=new xe({data:ra,label:"attribute-batch-buffer",usage:Q.VERTEX|Q.COPY_DST,shrinkToFit:!1}),i=new xe({data:na,label:"index-batch-buffer",usage:Q.INDEX|Q.COPY_DST,shrinkToFit:!1}),r=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0,location:1},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4,location:3},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4,location:0},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:5*4,location:2}},indexBuffer:i})}}const Pr=16,Sr={};function aa(s,t){let e=0;for(let i=0;i<t;i++)e=e*31+s[i].uid>>>0;return Sr[e]||ha(s,e)}function ha(s,t){const e={};let i=0;for(let n=0;n<Pr;n++){const o=n<s.length?s[n]:L.EMPTY.source;e[i++]=o.source,e[i++]=o.style}const r=new Kn(e);return Sr[t]=r,r}class bi{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function wi(s,t){const e=s.byteLength/8|0,i=new Float64Array(s,0,e);new Float64Array(t,0,e).set(i);const n=s.byteLength-e*8;if(n>0){const o=new Uint8Array(s,e*8,n);new Uint8Array(t,e*8,n).set(o)}}const la={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var ca=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=3]="RENDERING_MASK_REMOVE",s[s.NONE=4]="NONE",s))(ca||{});function Ai(s,t){return t.alphaMode==="no-premultiply-alpha"&&la[s]||s}class vi{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class Mi{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}let he=0;const Tr=class kr{constructor(t={}){this.uid=$("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._vertexSize=6,this._elements=[],this._batchPool=[],this._batchPoolIndex=0,this._textureBatchPool=[],this._textureBatchPoolIndex=0,t={...kr.defaultOptions,...t};const{vertexSize:e,indexSize:i}=t;this.attributeBuffer=new bi(e*this._vertexSize*4),this.indexBuffer=new Uint16Array(i)}begin(){this.batchIndex=0,this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0,this._batchPoolIndex=0,this._textureBatchPoolIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t.indexStart=this.indexSize,t.location=this.attributeSize,t.batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.vertexSize*this._vertexSize}checkAndUpdateTexture(t,e){const i=t.batch.textures.ids[e._source.uid];return!i&&i!==0?!1:(t.textureId=i,t.texture=e,!0)}updateElement(t){this.dirty=!0,t.packAttributes(this.attributeBuffer.float32View,this.attributeBuffer.uint32View,t.location,t.textureId)}break(t){const e=this._elements;let i=this._textureBatchPool[this._textureBatchPoolIndex++]||new vi;if(i.clear(),!e[this.elementStart])return;const r=e[this.elementStart];let n=Ai(r.blendMode,r.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const o=this.attributeBuffer.float32View,a=this.attributeBuffer.uint32View,h=this.indexBuffer;let c=this._batchIndexSize,l=this._batchIndexStart,u="startBatch",d=this._batchPool[this._batchPoolIndex++]||new Mi;for(let f=this.elementStart;f<this.elementSize;++f){const p=e[f];e[f]=null;const m=p.texture._source,x=Ai(p.blendMode,m),y=n!==x;if(m._batchTick===he&&!y){p.textureId=m._textureBindLocation,c+=p.indexSize,p.packAttributes(o,a,p.location,p.textureId),p.packIndex(h,p.indexStart,p.location/this._vertexSize),p.batch=d;continue}m._batchTick=he,(i.count>=Pr||y)&&(this._finishBatch(d,l,c-l,i,n,t,u),u="renderBatch",l=c,n=x,i=this._textureBatchPool[this._textureBatchPoolIndex++]||new vi,i.clear(),d=this._batchPool[this._batchPoolIndex++]||new Mi,++he),p.textureId=m._textureBindLocation=i.count,i.ids[m.uid]=i.count,i.textures[i.count++]=m,p.batch=d,c+=p.indexSize,p.packAttributes(o,a,p.location,p.textureId),p.packIndex(h,p.indexStart,p.location/this._vertexSize)}i.count>0&&(this._finishBatch(d,l,c-l,i,n,t,u),l=c,++he),this.elementStart=this.elementSize,this._batchIndexStart=l,this._batchIndexSize=c}_finishBatch(t,e,i,r,n,o,a){t.gpuBindGroup=null,t.action=a,t.batcher=this,t.textures=r,t.blendMode=n,t.start=e,t.size=i,++he,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),i=new bi(e);wi(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(t){const e=this.indexBuffer;let i=Math.max(t,e.length*1.5);i+=i%2;const r=i>65535?new Uint32Array(i):new Uint16Array(i);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)r[n]=e[n];else wi(e.buffer,r.buffer);this.indexBuffer=r}destroy(){for(let t=0;t<this.batches.length;t++)this.batches[t].destroy();this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t].batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Tr.defaultOptions={vertexSize:4,indexSize:6};let ua=Tr;function da(s,t,e,i,r,n,o,a=null){let h=0;e*=t,r*=n;const c=a.a,l=a.b,u=a.c,d=a.d,f=a.tx,p=a.ty;for(;h<o;){const g=s[e],m=s[e+1];i[r]=c*g+u*m+f,i[r+1]=l*g+d*m+p,r+=n,e+=t,h++}}function fa(s,t,e,i){let r=0;for(t*=e;r<i;)s[t]=0,s[t+1]=0,t+=e,r++}function Ir(s,t,e,i,r){const n=t.a,o=t.b,a=t.c,h=t.d,c=t.tx,l=t.ty;e=e||0,i=i||2,r=r||s.length/i-e;let u=e*i;for(let d=0;d<r;d++){const f=s[u],p=s[u+1];s[u]=n*f+a*p+c,s[u+1]=o*f+h*p+l,u+=i}}function pa(s,t,e){const i=s>>16&255,r=s>>8&255,n=s&255,o=t>>16&255,a=t>>8&255,h=t&255,c=i+(o-i)*e,l=r+(a-r)*e,u=n+(h-n)*e;return(c<<16)+(l<<8)+u}const as=16777215;function ma(s,t){return s===as||t===as?s+t-as:pa(s,t,.5)}class Er{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(t,e,i){const r=this.geometryData.indices;for(let n=0;n<this.indexSize;n++)t[e++]=r[n+this.indexOffset]+i-this.vertexOffset}packAttributes(t,e,i,r){const n=this.geometryData,o=this.renderable,a=n.vertices,h=n.uvs,c=this.vertexOffset*2,l=(this.vertexOffset+this.vertexSize)*2,u=this.color,d=u>>16|u&65280|(u&255)<<16;if(this.applyTransform){const f=ma(d,o.groupColor)+(this.alpha*o.groupAlpha*255<<24),p=o.groupTransform,g=r<<16|this.roundPixels&65535,m=p.a,x=p.b,y=p.c,_=p.d,b=p.tx,C=p.ty;for(let E=c;E<l;E+=2){const v=a[E],M=a[E+1];t[i]=m*v+y*M+b,t[i+1]=x*v+_*M+C,t[i+2]=h[E],t[i+3]=h[E+1],e[i+4]=f,e[i+5]=g,i+=6}}else{const f=d+(this.alpha*255<<24);for(let p=c;p<l;p+=2)t[i]=a[p],t[i+1]=a[p+1],t[i+2]=h[p],t[i+3]=h[p+1],e[i+4]=f,e[i+5]=r<<16,i+=6}}get vertSize(){return this.vertexSize}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.vertexOffset=this.vertexOffset,t.vertexSize=this.vertexSize,t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData}reset(){this.applyTransform=!0}}const hs={build(s,t){let e,i,r,n,o,a;if(s.type==="circle"){const b=s;e=b.x,i=b.y,o=a=b.radius,r=n=0}else if(s.type==="ellipse"){const b=s;e=b.x,i=b.y,o=b.halfWidth,a=b.halfHeight,r=n=0}else{const b=s,C=b.width/2,E=b.height/2;e=b.x+C,i=b.y+E,o=a=Math.max(0,Math.min(b.radius,Math.min(C,E))),r=C-o,n=E-a}if(!(o>=0&&a>=0&&r>=0&&n>=0))return t;const h=Math.ceil(2.3*Math.sqrt(o+a)),c=h*8+(r?4:0)+(n?4:0);if(c===0)return t;if(h===0)return t[0]=t[6]=e+r,t[1]=t[3]=i+n,t[2]=t[4]=e-r,t[5]=t[7]=i-n,t;let l=0,u=h*4+(r?2:0)+2,d=u,f=c,p=r+o,g=n,m=e+p,x=e-p,y=i+g;if(t[l++]=m,t[l++]=y,t[--u]=y,t[--u]=x,n){const b=i-g;t[d++]=x,t[d++]=b,t[--f]=b,t[--f]=m}for(let b=1;b<h;b++){const C=Math.PI/2*(b/h),E=r+Math.cos(C)*o,v=n+Math.sin(C)*a,M=e+E,w=e-E,A=i+v,U=i-v;t[l++]=M,t[l++]=A,t[--u]=A,t[--u]=w,t[d++]=w,t[d++]=U,t[--f]=U,t[--f]=M}p=r,g=n+a,m=e+p,x=e-p,y=i+g;const _=i-g;return t[l++]=m,t[l++]=y,t[--f]=_,t[--f]=m,r&&(t[l++]=x,t[l++]=y,t[--f]=_,t[--f]=x),t},triangulate(s,t,e,i,r,n){if(s.length===0)return;let o=0,a=0;for(let l=0;l<s.length;l+=2)o+=s[l],a+=s[l+1];o/=s.length/2,a/=s.length/2;let h=i;t[h*e]=o,t[h*e+1]=a;const c=h++;for(let l=0;l<s.length;l+=2)t[h*e]=s[l],t[h*e+1]=s[l+1],l>0&&(r[n++]=h,r[n++]=c,r[n++]=h-1),h++;r[n++]=c+1,r[n++]=c,r[n++]=h-1}},ga=1e-4,Ci=1e-4;function ya(s){const t=s.length;if(t<6)return 1;let e=0;for(let i=0,r=s[t-2],n=s[t-1];i<t;i+=2){const o=s[i],a=s[i+1];e+=(o-r)*(a+n),r=o,n=a}return e<0?-1:1}function Pi(s,t,e,i,r,n,o,a){const h=s-e*r,c=t-i*r,l=s+e*n,u=t+i*n;let d,f;o?(d=i,f=-e):(d=-i,f=e);const p=h+d,g=c+f,m=l+d,x=u+f;return a.push(p,g),a.push(m,x),2}function Et(s,t,e,i,r,n,o,a){const h=e-s,c=i-t;let l=Math.atan2(h,c),u=Math.atan2(r-s,n-t);a&&l<u?l+=Math.PI*2:!a&&l>u&&(u+=Math.PI*2);let d=l;const f=u-l,p=Math.abs(f),g=Math.sqrt(h*h+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,x=f/m;if(d+=x,a){o.push(s,t),o.push(e,i);for(let y=1,_=d;y<m;y++,_+=x)o.push(s,t),o.push(s+Math.sin(_)*g,t+Math.cos(_)*g);o.push(s,t),o.push(r,n)}else{o.push(e,i),o.push(s,t);for(let y=1,_=d;y<m;y++,_+=x)o.push(s+Math.sin(_)*g,t+Math.cos(_)*g),o.push(s,t);o.push(r,n),o.push(s,t)}return m*2}function _a(s,t,e,i,r,n,o,a,h){const c=ga;if(s.length===0)return;const l=t;let u=l.alignment;if(t.alignment!==.5){let F=ya(s);e&&(F*=-1),u=(u-.5)*F+.5}const d=new q(s[0],s[1]),f=new q(s[s.length-2],s[s.length-1]),p=i,g=Math.abs(d.x-f.x)<c&&Math.abs(d.y-f.y)<c;if(p){s=s.slice(),g&&(s.pop(),s.pop(),f.set(s[s.length-2],s[s.length-1]));const F=(d.x+f.x)*.5,Mt=(f.y+d.y)*.5;s.unshift(F,Mt),s.push(F,Mt)}const m=r,x=s.length/2;let y=s.length;const _=m.length/2,b=l.width/2,C=b*b,E=l.miterLimit*l.miterLimit;let v=s[0],M=s[1],w=s[2],A=s[3],U=0,_t=0,T=-(M-A),S=v-w,G=0,N=0,at=Math.sqrt(T*T+S*S);T/=at,S/=at,T*=b,S*=b;const js=u,P=(1-js)*2,I=js*2;p||(l.cap==="round"?y+=Et(v-T*(P-I)*.5,M-S*(P-I)*.5,v-T*P,M-S*P,v+T*I,M+S*I,m,!0)+2:l.cap==="square"&&(y+=Pi(v,M,T,S,P,I,!0,m))),m.push(v-T*P,M-S*P),m.push(v+T*I,M+S*I);for(let F=1;F<x-1;++F){v=s[(F-1)*2],M=s[(F-1)*2+1],w=s[F*2],A=s[F*2+1],U=s[(F+1)*2],_t=s[(F+1)*2+1],T=-(M-A),S=v-w,at=Math.sqrt(T*T+S*S),T/=at,S/=at,T*=b,S*=b,G=-(A-_t),N=w-U,at=Math.sqrt(G*G+N*N),G/=at,N/=at,G*=b,N*=b;const Mt=w-v,se=M-A,ie=w-U,re=_t-A,qs=Mt*ie+se*re,Ae=se*ie-re*Mt,ne=Ae<0;if(Math.abs(Ae)<.001*Math.abs(qs)){m.push(w-T*P,A-S*P),m.push(w+T*I,A+S*I),qs>=0&&(l.join==="round"?y+=Et(w,A,w-T*P,A-S*P,w-G*P,A-N*P,m,!1)+4:y+=2,m.push(w-G*I,A-N*I),m.push(w+G*P,A+N*P));continue}const Zs=(-T+v)*(-S+A)-(-T+w)*(-S+M),Ks=(-G+U)*(-N+A)-(-G+w)*(-N+_t),ve=(Mt*Ks-ie*Zs)/Ae,Me=(re*Zs-se*Ks)/Ae,$e=(ve-w)*(ve-w)+(Me-A)*(Me-A),St=w+(ve-w)*P,Tt=A+(Me-A)*P,kt=w-(ve-w)*I,It=A-(Me-A)*I,$r=Math.min(Mt*Mt+se*se,ie*ie+re*re),Qs=ne?P:I,jr=$r+Qs*Qs*C;$e<=jr?l.join==="bevel"||$e/C>E?(ne?(m.push(St,Tt),m.push(w+T*I,A+S*I),m.push(St,Tt),m.push(w+G*I,A+N*I)):(m.push(w-T*P,A-S*P),m.push(kt,It),m.push(w-G*P,A-N*P),m.push(kt,It)),y+=2):l.join==="round"?ne?(m.push(St,Tt),m.push(w+T*I,A+S*I),y+=Et(w,A,w+T*I,A+S*I,w+G*I,A+N*I,m,!0)+4,m.push(St,Tt),m.push(w+G*I,A+N*I)):(m.push(w-T*P,A-S*P),m.push(kt,It),y+=Et(w,A,w-T*P,A-S*P,w-G*P,A-N*P,m,!1)+4,m.push(w-G*P,A-N*P),m.push(kt,It)):(m.push(St,Tt),m.push(kt,It)):(m.push(w-T*P,A-S*P),m.push(w+T*I,A+S*I),l.join==="round"?ne?y+=Et(w,A,w+T*I,A+S*I,w+G*I,A+N*I,m,!0)+2:y+=Et(w,A,w-T*P,A-S*P,w-G*P,A-N*P,m,!1)+2:l.join==="miter"&&$e/C<=E&&(ne?(m.push(kt,It),m.push(kt,It)):(m.push(St,Tt),m.push(St,Tt)),y+=2),m.push(w-G*P,A-N*P),m.push(w+G*I,A+N*I),y+=2)}v=s[(x-2)*2],M=s[(x-2)*2+1],w=s[(x-1)*2],A=s[(x-1)*2+1],T=-(M-A),S=v-w,at=Math.sqrt(T*T+S*S),T/=at,S/=at,T*=b,S*=b,m.push(w-T*P,A-S*P),m.push(w+T*I,A+S*I),p||(l.cap==="round"?y+=Et(w-T*(P-I)*.5,A-S*(P-I)*.5,w-T*P,A-S*P,w+T*I,A+S*I,m,!1)+2:l.cap==="square"&&(y+=Pi(w,A,T,S,P,I,!1,m)));const Vr=Ci*Ci;for(let F=_;F<y+_-2;++F)v=m[F*2],M=m[F*2+1],w=m[(F+1)*2],A=m[(F+1)*2+1],U=m[(F+2)*2],_t=m[(F+2)*2+1],!(Math.abs(v*(A-_t)+w*(_t-M)+U*(M-A))<Vr)&&a.push(F,F+1,F+2)}function Br(s,t,e,i,r,n,o){const a=yo(s,t,2);if(!a)return;for(let c=0;c<a.length;c+=3)n[o++]=a[c]+r,n[o++]=a[c+1]+r,n[o++]=a[c+2]+r;let h=r*i;for(let c=0;c<s.length;c+=2)e[h]=s[c],e[h+1]=s[c+1],h+=i}const xa=[],ba={build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return t},triangulate(s,t,e,i,r,n){Br(s,xa,t,e,i,r,n)}},wa={build(s,t){const e=s,i=e.x,r=e.y,n=e.width,o=e.height;return n>=0&&o>=0&&(t[0]=i,t[1]=r,t[2]=i+n,t[3]=r,t[4]=i+n,t[5]=r+o,t[6]=i,t[7]=r+o),t},triangulate(s,t,e,i,r,n){let o=0;i*=e,t[i+o]=s[0],t[i+o+1]=s[1],o+=e,t[i+o]=s[2],t[i+o+1]=s[3],o+=e,t[i+o]=s[6],t[i+o+1]=s[7],o+=e,t[i+o]=s[4],t[i+o+1]=s[5],o+=e;const a=i/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2,r[n++]=a+1,r[n++]=a+3,r[n++]=a+2}},Aa={build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,t},triangulate(s,t,e,i,r,n){let o=0;i*=e,t[i+o]=s[0],t[i+o+1]=s[1],o+=e,t[i+o]=s[2],t[i+o+1]=s[3],o+=e,t[i+o]=s[4],t[i+o+1]=s[5];const a=i/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2}},zs={rectangle:wa,polygon:ba,triangle:Aa,circle:hs,ellipse:hs,roundedRectangle:hs},va=new V;function Ma(s,t){const{geometryData:e,batches:i}=t;i.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<s.instructions.length;r++){const n=s.instructions[r];if(n.action==="texture")Ca(n.data,i,e);else if(n.action==="fill"||n.action==="stroke"){const o=n.action==="stroke",a=n.data.path.shapePath,h=n.data.style,c=n.data.hole;o&&c&&Si(c.shapePath,h,null,!0,i,e),Si(a,h,c,o,i,e)}}}function Ca(s,t,e){const{vertices:i,uvs:r,indices:n}=e,o=n.length,a=i.length/2,h=[],c=zs.rectangle,l=va,u=s.image;l.x=s.dx,l.y=s.dy,l.width=s.dw,l.height=s.dh;const d=s.transform;c.build(l,h),d&&Ir(h,d),c.triangulate(h,i,2,a,n,o);const f=u.uvs;r.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=lt.get(Er);p.indexOffset=o,p.indexSize=n.length-o,p.vertexOffset=a,p.vertexSize=i.length/2-a,p.color=s.style,p.alpha=s.alpha,p.texture=u,p.geometryData=e,t.push(p)}function Si(s,t,e,i,r,n){const{vertices:o,uvs:a,indices:h}=n,c=s.shapePrimitives.length-1;s.shapePrimitives.forEach(({shape:l,transform:u},d)=>{const f=h.length,p=o.length/2,g=[],m=zs[l.type];if(m.build(l,g),u&&Ir(g,u),i){const b=l.closePath??!0;_a(g,t,!1,b,o,2,p,h)}else if(e&&c===d){c!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const b=[],C=g.slice();Pa(e.shapePath).forEach(v=>{b.push(C.length/2),C.push(...v)}),Br(C,b,o,2,p,h,f)}else m.triangulate(g,o,2,p,h,f);const x=a.length/2,y=t.texture;if(y!==L.WHITE){const b=t.matrix;u&&b.append(u.clone().invert()),da(o,2,p,a,x,2,o.length/2-p,b)}else fa(a,x,2,o.length/2-p);const _=lt.get(Er);_.indexOffset=f,_.indexSize=h.length-f,_.vertexOffset=p,_.vertexSize=o.length/2-p,_.color=t.color,_.alpha=t.alpha,_.texture=y,_.geometryData=n,r.push(_)})}function Pa(s){if(!s)return[];const t=s.shapePrimitives,e=[];for(let i=0;i<t.length;i++){const r=t[i].shape,n=[];zs[r.type].build(r,n),e.push(n)}return e}class Sa{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Ta{constructor(){this.geometry=new oa,this.instructions=new er}init(){this.instructions.reset()}}const Hs=class Ms{constructor(){this._activeBatchers=[],this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._needsContextNeedsRebuild=[]}init(t){Ms.defaultOptions.bezierSmoothness=t?.bezierSmoothness??Ms.defaultOptions.bezierSmoothness}prerender(){this._returnActiveBatchers()}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Ma(t,e);const i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_returnActiveBatchers(){for(let t=0;t<this._activeBatchers.length;t++)lt.return(this._activeBatchers[t]);this._activeBatchers.length=0}_initContextRenderData(t){const e=lt.get(Ta),{batches:i,geometryData:r}=this._gpuContextHash[t.uid],n=r.vertices.length,o=r.indices.length;for(let l=0;l<i.length;l++)i[l].applyTransform=!1;const a=lt.get(ua);this._activeBatchers.push(a),a.ensureAttributeBuffer(n),a.ensureIndexBuffer(o),a.begin();for(let l=0;l<i.length;l++){const u=i[l];a.add(u)}a.finish(e.instructions);const h=e.geometry;h.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),h.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const c=a.batches;for(let l=0;l<c.length;l++){const u=c[l];u.bindGroup=aa(u.textures.textures,u.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Sa;return this._gpuContextHash[t.uid]=e,t.on("update",this.onGraphicsContextUpdate,this),t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextUpdate(t){this._needsContextNeedsRebuild.push(t)}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("update",this.onGraphicsContextUpdate,this),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(lt.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(i=>{lt.return(i)})}destroy(){for(const t of this._needsContextNeedsRebuild)this._gpuContextHash[t.uid]&&this.onGraphicsContextDestroy(t);this._needsContextNeedsRebuild.length=0}};Hs.extension={type:[k.WebGLSystem,k.WebGPUSystem,k.CanvasSystem],name:"graphicsContext"};Hs.defaultOptions={bezierSmoothness:.5};let Rr=Hs;const ka=8,Le=11920929e-14,Ia=1;function Fr(s,t,e,i,r,n,o,a,h,c){const u=Math.min(.99,Math.max(0,c??Rr.defaultOptions.bezierSmoothness));let d=(Ia-u)/1;return d*=d,Ea(t,e,i,r,n,o,a,h,s,d),s}function Ea(s,t,e,i,r,n,o,a,h,c){Cs(s,t,e,i,r,n,o,a,h,c,0),h.push(o,a)}function Cs(s,t,e,i,r,n,o,a,h,c,l){if(l>ka)return;const u=(s+e)/2,d=(t+i)/2,f=(e+r)/2,p=(i+n)/2,g=(r+o)/2,m=(n+a)/2,x=(u+f)/2,y=(d+p)/2,_=(f+g)/2,b=(p+m)/2,C=(x+_)/2,E=(y+b)/2;if(l>0){let v=o-s,M=a-t;const w=Math.abs((e-o)*M-(i-a)*v),A=Math.abs((r-o)*M-(n-a)*v);if(w>Le&&A>Le){if((w+A)*(w+A)<=c*(v*v+M*M)){h.push(C,E);return}}else if(w>Le){if(w*w<=c*(v*v+M*M)){h.push(C,E);return}}else if(A>Le){if(A*A<=c*(v*v+M*M)){h.push(C,E);return}}else if(v=C-(s+o)/2,M=E-(t+a)/2,v*v+M*M<=c){h.push(C,E);return}}Cs(s,t,u,d,x,y,C,E,h,c,l+1),Cs(C,E,_,b,g,m,o,a,h,c,l+1)}const Ba=8,Ra=11920929e-14,Fa=1;function La(s,t,e,i,r,n,o,a){const c=Math.min(.99,Math.max(0,a??Rr.defaultOptions.bezierSmoothness));let l=(Fa-c)/1;return l*=l,Ga(t,e,i,r,n,o,s,l),s}function Ga(s,t,e,i,r,n,o,a){Ps(o,s,t,e,i,r,n,a,0),o.push(r,n)}function Ps(s,t,e,i,r,n,o,a,h){if(h>Ba)return;const c=(t+i)/2,l=(e+r)/2,u=(i+n)/2,d=(r+o)/2,f=(c+u)/2,p=(l+d)/2;let g=n-t,m=o-e;const x=Math.abs((i-n)*m-(r-o)*g);if(x>Ra){if(x*x<=a*(g*g+m*m)){s.push(f,p);return}}else if(g=f-(t+n)/2,m=p-(e+o)/2,g*g+m*m<=a){s.push(f,p);return}Ps(s,t,e,c,l,f,p,a,h+1),Ps(s,f,p,u,d,n,o,a,h+1)}function Lr(s,t,e,i,r,n,o,a){let h=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(h=2*Math.PI-h),a=a||Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI))),a=Math.max(a,3);let c=h/a,l=r;c*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(l),f=Math.sin(l),p=t+d*i,g=e+f*i;s.push(p,g),l+=c}}function Da(s,t,e,i,r,n){const o=s[s.length-2],h=s[s.length-1]-e,c=o-t,l=r-e,u=i-t,d=Math.abs(h*u-c*l);if(d<1e-8||n===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const f=h*h+c*c,p=l*l+u*u,g=h*l+c*u,m=n*Math.sqrt(f)/d,x=n*Math.sqrt(p)/d,y=m*g/f,_=x*g/p,b=m*u+x*c,C=m*l+x*h,E=c*(x+y),v=h*(x+y),M=u*(m+_),w=l*(m+_),A=Math.atan2(v-C,E-b),U=Math.atan2(w-C,M-b);Lr(s,b+t,C+e,n,A,U,c*l>u*h)}const pe=Math.PI*2,ls={centerX:0,centerY:0,ang1:0,ang2:0},cs=({x:s,y:t},e,i,r,n,o,a,h)=>{s*=e,t*=i;const c=r*s-n*t,l=n*s+r*t;return h.x=c+o,h.y=l+a,h};function Oa(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,r=Math.cos(s),n=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:r-n*i,y:n+r*i},{x:o+a*i,y:a-o*i},{x:o,y:a}]}const Ti=(s,t,e,i)=>{const r=s*i-t*e<0?-1:1;let n=s*e+t*i;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},Ua=(s,t,e,i,r,n,o,a,h,c,l,u,d)=>{const f=Math.pow(r,2),p=Math.pow(n,2),g=Math.pow(l,2),m=Math.pow(u,2);let x=f*p-f*m-p*g;x<0&&(x=0),x/=f*m+p*g,x=Math.sqrt(x)*(o===a?-1:1);const y=x*r/n*u,_=x*-n/r*l,b=c*y-h*_+(s+e)/2,C=h*y+c*_+(t+i)/2,E=(l-y)/r,v=(u-_)/n,M=(-l-y)/r,w=(-u-_)/n,A=Ti(1,0,E,v);let U=Ti(E,v,M,w);a===0&&U>0&&(U-=pe),a===1&&U<0&&(U+=pe),d.centerX=b,d.centerY=C,d.ang1=A,d.ang2=U};function Na(s,t,e,i,r,n,o,a=0,h=0,c=0){if(n===0||o===0)return;const l=Math.sin(a*pe/360),u=Math.cos(a*pe/360),d=u*(t-i)/2+l*(e-r)/2,f=-l*(t-i)/2+u*(e-r)/2;if(d===0&&f===0)return;n=Math.abs(n),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(n*=Math.sqrt(p),o*=Math.sqrt(p)),Ua(t,e,i,r,n,o,h,c,l,u,d,f,ls);let{ang1:g,ang2:m}=ls;const{centerX:x,centerY:y}=ls;let _=Math.abs(m)/(pe/4);Math.abs(1-_)<1e-7&&(_=1);const b=Math.max(Math.ceil(_),1);m/=b;let C=s[s.length-2],E=s[s.length-1];const v={x:0,y:0};for(let M=0;M<b;M++){const w=Oa(g,m),{x:A,y:U}=cs(w[0],n,o,u,l,x,y,v),{x:_t,y:T}=cs(w[1],n,o,u,l,x,y,v),{x:S,y:G}=cs(w[2],n,o,u,l,x,y,v);Fr(s,C,E,A,U,_t,T,S,G),C=S,E=G,g+=m}}function za(s,t,e){const i=(o,a)=>{const h=a.x-o.x,c=a.y-o.y,l=Math.sqrt(h*h+c*c),u=h/l,d=c/l;return{len:l,nx:u,ny:d}},r=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let n=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],h=a.radius??e;if(h<=0){r(o,a),n=a;continue}const c=t[(o+1)%t.length],l=i(a,n),u=i(a,c);if(l.len<1e-4||u.len<1e-4){r(o,a),n=a;continue}let d=Math.asin(l.nx*u.ny-l.ny*u.nx),f=1,p=!1;l.nx*u.nx-l.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,x=Math.abs(Math.cos(g)*h/Math.sin(g));x>Math.min(l.len/2,u.len/2)?(x=Math.min(l.len/2,u.len/2),m=Math.abs(x*Math.sin(g)/Math.cos(g))):m=h;const y=a.x+u.nx*x+-u.ny*m*f,_=a.y+u.ny*x+u.nx*m*f,b=Math.atan2(l.ny,l.nx)+Math.PI/2*f,C=Math.atan2(u.ny,u.nx)-Math.PI/2*f;o===0&&s.moveTo(y+Math.cos(b)*m,_+Math.sin(b)*m),s.arc(y,_,m,b,C,p),n=a}}function Ha(s,t,e,i){const r=(a,h)=>Math.sqrt((a.x-h.x)**2+(a.y-h.y)**2),n=(a,h,c)=>({x:a.x+(h.x-a.x)*c,y:a.y+(h.y-a.y)*c}),o=t.length;for(let a=0;a<o;a++){const h=t[(a+1)%o],c=h.radius??e;if(c<=0){a===0?s.moveTo(h.x,h.y):s.lineTo(h.x,h.y);continue}const l=t[a],u=t[(a+2)%o],d=r(l,h);let f;if(d<1e-4)f=h;else{const m=Math.min(d/2,c);f=n(h,l,m/d)}const p=r(u,h);let g;if(p<1e-4)g=h;else{const m=Math.min(p/2,c);g=n(h,u,m/p)}a===0?s.moveTo(f.x,f.y):s.lineTo(f.x,f.y),s.quadraticCurveTo(h.x,h.y,g.x,g.y,i)}}const Wa=new V;class Ya{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new vt,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this._currentPoly.points,r=i[i.length-2],n=i[i.length-1];return(r!==t||n!==e)&&i.push(t,e),this}arc(t,e,i,r,n,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Lr(a,t,e,i,r,n,o),this}arcTo(t,e,i,r,n){this._ensurePoly();const o=this._currentPoly.points;return Da(o,t,e,i,r,n),this}arcToSvg(t,e,i,r,n,o,a){const h=this._currentPoly.points;return Na(h,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,o,a){this._ensurePoly();const h=this._currentPoly;return Fr(this._currentPoly.points,h.lastX,h.lastY,t,e,i,r,n,o,a),this}quadraticCurveTo(t,e,i,r,n){this._ensurePoly();const o=this._currentPoly;return La(this._currentPoly.points,o.lastX,o.lastY,t,e,i,r,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let i=0;i<t.instructions.length;i++){const r=t.instructions[i];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,r,n){return this.drawShape(new V(t,e,i,r),n),this}circle(t,e,i,r){return this.drawShape(new Os(t,e,i),r),this}poly(t,e,i){const r=new fe(t);return r.closePath=e,this.drawShape(r,i),this}regularPoly(t,e,i,r,n=0,o){r=Math.max(r|0,3);const a=-1*Math.PI/2+n,h=Math.PI*2/r,c=[];for(let l=0;l<r;l++){const u=l*h+a;c.push(t+i*Math.cos(u),e+i*Math.sin(u))}return this.poly(c,!0,o),this}roundPoly(t,e,i,r,n,o=0,a){if(r=Math.max(r|0,3),n<=0)return this.regularPoly(t,e,i,r,o);const h=i*Math.sin(Math.PI/r)-.001;n=Math.min(n,h);const c=-1*Math.PI/2+o,l=Math.PI*2/r,u=(r-2)*Math.PI/r/2;for(let d=0;d<r;d++){const f=d*l+c,p=t+i*Math.cos(f),g=e+i*Math.sin(f),m=f+Math.PI+u,x=f-Math.PI-u,y=p+n*Math.cos(m),_=g+n*Math.sin(m),b=p+n*Math.cos(x),C=g+n*Math.sin(x);d===0?this.moveTo(y,_):this.lineTo(y,_),this.quadraticCurveTo(p,g,b,C,a)}return this.closePath()}roundShape(t,e,i=!1,r){return t.length<3?this:(i?Ha(this,t,e,r):za(this,t,e),this.closePath())}filletRect(t,e,i,r,n){if(n===0)return this.rect(t,e,i,r);const o=Math.min(i,r)/2,a=Math.min(o,Math.max(-o,n)),h=t+i,c=e+r,l=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,e+u).arcTo(t+l,e+l,t+u,e,u).lineTo(h-u,e).arcTo(h-l,e+l,h,e+u,u).lineTo(h,c-u).arcTo(h-l,c-l,t+i-u,c,u).lineTo(t+u,c).arcTo(t+l,c-l,t,c-u,u).closePath()}chamferRect(t,e,i,r,n,o){if(n<=0)return this.rect(t,e,i,r);const a=Math.min(n,Math.min(i,r)/2),h=t+i,c=e+r,l=[t+a,e,h-a,e,h,e+a,h,c-a,h-a,c,t+a,c,t,c-a,t,e+a];for(let u=l.length-1;u>=2;u-=2)l[u]===l[u-2]&&l[u-1]===l[u-3]&&l.splice(u-1,2);return this.poly(l,!0,o)}ellipse(t,e,i,r,n){return this.drawShape(new Us(t,e,i,r),n),this}roundRect(t,e,i,r,n,o){return this.drawShape(new Ns(t,e,i,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),i=new fe,i.points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new fe,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,r=e.shape.y;if(!e.transform.isIdentity()){const n=e.transform,o=i;i=n.a*i+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this._currentPoly.points.push(i,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const r=e[i],n=r.shape.getBounds(Wa);r.transform?t.addRect(n,r.transform):t.addRect(n)}return t}}class Qt{constructor(t){this.instructions=[],this.uid=$("graphicsPath"),this._dirty=!0,typeof t=="string"?Jo(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new Ya(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,r,n){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(q.shared);let h=0,c=0;if(!o||o.action!=="bezierCurveTo")h=a.x,c=a.y;else{h=o.data[2],c=o.data[3];const l=a.x,u=a.y;h=l+(l-h),c=u+(u-c)}return this.instructions.push({action:"bezierCurveTo",data:[h,c,t,e,i,r,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){const r=this.instructions[this.instructions.length-1],n=this.getLastPoint(q.shared);let o=0,a=0;if(!r||r.action!=="quadraticCurveTo")o=n.x,a=n.y;else{o=r.data[0],a=r.data[1];const h=n.x,c=n.y;o=h+(h-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,i]}),this._dirty=!0,this}rect(t,e,i,r,n){return this.instructions.push({action:"rect",data:[t,e,i,r,n]}),this._dirty=!0,this}circle(t,e,i,r){return this.instructions.push({action:"circle",data:[t,e,i,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,r,n,o,a){n=n||r/2;const h=-1*Math.PI/2+o,c=i*2,l=Math.PI*2/c,u=[];for(let d=0;d<c;d++){const f=d%2?n:r,p=d*l+h;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new Qt;if(!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const r=this.instructions[i];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let h=0,c=0,l=0,u=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const x=this.instructions[m],y=x.data;switch(x.action){case"moveTo":case"lineTo":h=y[0],c=y[1],y[0]=e*h+r*c+o,y[1]=i*h+n*c+a;break;case"bezierCurveTo":l=y[0],u=y[1],d=y[2],f=y[3],h=y[4],c=y[5],y[0]=e*l+r*u+o,y[1]=i*l+n*u+a,y[2]=e*d+r*f+o,y[3]=i*d+n*f+a,y[4]=e*h+r*c+o,y[5]=i*h+n*c+a;break;case"quadraticCurveTo":l=y[0],u=y[1],h=y[2],c=y[3],y[0]=e*l+r*u+o,y[1]=i*l+n*u+a,y[2]=e*h+r*c+o,y[3]=i*h+n*c+a;break;case"arcToSvg":h=y[5],c=y[6],p=y[0],g=y[1],y[0]=e*p+r*g,y[1]=i*p+n*g,y[5]=e*h+r*c+o,y[6]=i*h+n*c+a;break;case"circle":y[4]=le(y[3],t);break;case"rect":y[4]=le(y[4],t);break;case"ellipse":y[8]=le(y[8],t);break;case"roundRect":y[5]=le(y[5],t);break;case"addPath":y[0].transform(t);break;case"poly":y[2]=le(y[2],t);break;default:j("unknown transform action",x.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t);break}return t}}function le(s,t){return s?s.prepend(t):t.clone()}function Xa(s,t){if(typeof s=="string"){const i=document.createElement("div");i.innerHTML=s.trim(),s=i.querySelector("svg")}const e={context:t,path:new Qt};return Gr(s,e,null,null),t}function Gr(s,t,e,i){const r=s.children,{fillStyle:n,strokeStyle:o}=Va(s);n&&e?e={...e,...n}:n&&(e=n),o&&i?i={...i,...o}:o&&(i=o),t.context.fillStyle=e,t.context.strokeStyle=i;let a,h,c,l,u,d,f,p,g,m,x,y,_,b,C,E,v;switch(s.nodeName.toLowerCase()){case"path":b=s.getAttribute("d"),C=new Qt(b),t.context.path(C),e&&t.context.fill(),i&&t.context.stroke();break;case"circle":f=Y(s,"cx",0),p=Y(s,"cy",0),g=Y(s,"r",0),t.context.ellipse(f,p,g,g),e&&t.context.fill(),i&&t.context.stroke();break;case"rect":a=Y(s,"x",0),h=Y(s,"y",0),E=Y(s,"width",0),v=Y(s,"height",0),m=Y(s,"rx",0),x=Y(s,"ry",0),m||x?t.context.roundRect(a,h,E,v,m||x):t.context.rect(a,h,E,v),e&&t.context.fill(),i&&t.context.stroke();break;case"ellipse":f=Y(s,"cx",0),p=Y(s,"cy",0),m=Y(s,"rx",0),x=Y(s,"ry",0),t.context.beginPath(),t.context.ellipse(f,p,m,x),e&&t.context.fill(),i&&t.context.stroke();break;case"line":c=Y(s,"x1",0),l=Y(s,"y1",0),u=Y(s,"x2",0),d=Y(s,"y2",0),t.context.beginPath(),t.context.moveTo(c,l),t.context.lineTo(u,d),i&&t.context.stroke();break;case"polygon":_=s.getAttribute("points"),y=_.match(/\d+/g).map(M=>parseInt(M,10)),t.context.poly(y,!0),e&&t.context.fill(),i&&t.context.stroke();break;case"polyline":_=s.getAttribute("points"),y=_.match(/\d+/g).map(M=>parseInt(M,10)),t.context.poly(y,!1),i&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}for(let M=0;M<r.length;M++)Gr(r[M],t,e,i)}function Y(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function Va(s){const t=s.getAttribute("style"),e={},i={};let r=!1,n=!1;if(t){const o=t.split(";");for(let a=0;a<o.length;a++){const h=o[a],[c,l]=h.split(":");switch(c){case"stroke":l!=="none"&&(e.color=st.shared.setValue(l).toNumber(),n=!0);break;case"stroke-width":e.width=Number(l);break;case"fill":l!=="none"&&(r=!0,i.color=st.shared.setValue(l).toNumber());break;case"fill-opacity":i.alpha=Number(l);break;case"stroke-opacity":e.alpha=Number(l);break;case"opacity":i.alpha=Number(l),e.alpha=Number(l);break}}}else{const o=s.getAttribute("stroke");o&&o!=="none"&&(n=!0,e.color=st.shared.setValue(o).toNumber(),e.width=Y(s,"stroke-width",1));const a=s.getAttribute("fill");a&&a!=="none"&&(r=!0,i.color=st.shared.setValue(a).toNumber())}return{strokeStyle:n?e:null,fillStyle:r?i:null}}const Dr=class Ss{constructor(t,e,i,r){this.uid=$("fillGradient"),this.type="linear",this.gradientStops=[],this.x0=t,this.y0=e,this.x1=i,this.y1=r}addColorStop(t,e){return this.gradientStops.push({offset:t,color:st.shared.setValue(e).toHex()}),this}buildLinearGradient(){const t=Ss.defaultTextureSize,{gradientStops:e}=this,i=J.get().createCanvas();i.width=t,i.height=t;const r=i.getContext("2d"),n=r.createLinearGradient(0,0,Ss.defaultTextureSize,1);for(let g=0;g<e.length;g++){const m=e[g];n.addColorStop(m.offset,m.color)}r.fillStyle=n,r.fillRect(0,0,t,t),this.texture=new L({source:new be({resource:i,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:o,y0:a,x1:h,y1:c}=this,l=new R,u=h-o,d=c-a,f=Math.sqrt(u*u+d*d),p=Math.atan2(d,u);l.translate(-o,-a),l.scale(1/t,1/t),l.rotate(-p),l.scale(256/f,1),this.transform=l}};Dr.defaultTextureSize=256;let $a=Dr;const ki={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ja{constructor(t,e){this.uid=$("fillPattern"),this.transform=new R,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=ki[e].addressModeU,t.source.style.addressModeV=ki[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height)}}function Ht(s,t){if(s==null)return null;let e,i;if(s?.fill?(i=s.fill,e={...t,...s}):(i=s,e=t),st.isColorLike(i)){const o=st.shared.setValue(i??0);return{...e,color:o.toNumber(),alpha:o.alpha===1?e.alpha:o.alpha,texture:L.WHITE}}else if(i instanceof ja){const o=i;return{...e,color:16777215,texture:o.texture,matrix:o.transform,fill:e.fill??null}}else if(i instanceof $a){const o=i;return o.buildLinearGradient(),{...e,color:16777215,texture:o.texture,matrix:o.transform}}const r={...t,...s};if(r.texture){if(r.texture!==L.WHITE){const a=r.matrix?.invert()||new R;a.scale(1/r.texture.frame.width,1/r.texture.frame.height),r.matrix=a}const o=r.texture.source.style;o.addressMode==="clamp-to-edge"&&(o.addressMode="repeat")}const n=st.shared.setValue(r.color);return r.alpha*=n.alpha,r.color=n.toNumber(),r.matrix=r.matrix?r.matrix.clone():null,r}const qa=new q,Ii=new R,Ws=class pt extends Ct{constructor(){super(...arguments),this.uid=$("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Qt,this._transform=new R,this._fillStyle={...pt.defaultFillStyle},this._strokeStyle={...pt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new vt,this._boundsDirty=!0}clone(){const t=new pt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Ht(t,pt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ht(t,pt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Ht(t,pt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Ht(t,pt.defaultStrokeStyle),this}texture(t,e,i,r,n,o){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:r||0,dw:n||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?st.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Qt,this}fill(t,e){let i;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?i=r.data.path:i=this._activePath.clone(),i?(t!=null&&(e!==void 0&&typeof t=="number"&&(H(z,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Ht(t,pt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(q.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ht(t,pt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,r,n,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,i,r,n,o),this}arcTo(t,e,i,r,n){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,n),this}arcToSvg(t,e,i,r,n,o,a){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,i,r,n,h.a*o+h.c*a+h.tx,h.b*o+h.d*a+h.ty),this}bezierCurveTo(t,e,i,r,n,o,a){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*i+h.c*r+h.tx,h.b*i+h.d*r+h.ty,h.a*n+h.c*o+h.tx,h.b*n+h.d*o+h.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,i,r){return this._tick++,this._activePath.ellipse(t,e,i,r,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform,r=this._activePath.instructions,n=i.a*t+i.c*e+i.tx,o=i.b*t+i.d*e+i.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=n,r[0].data[1]=o,this):(this._activePath.moveTo(n,o),this)}quadraticCurveTo(t,e,i,r,n){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,n),this}rect(t,e,i,r){return this._tick++,this._activePath.rect(t,e,i,r,this._transform.clone()),this}roundRect(t,e,i,r,n){return this._tick++,this._activePath.roundRect(t,e,i,r,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,r,n=0,o){return this._tick++,this._activePath.regularPoly(t,e,i,r,n,o),this}roundPoly(t,e,i,r,n,o){return this._tick++,this._activePath.roundPoly(t,e,i,r,n,o),this}roundShape(t,e,i,r){return this._tick++,this._activePath.roundShape(t,e,i,r),this}filletRect(t,e,i,r,n){return this._tick++,this._activePath.filletRect(t,e,i,r,n),this}chamferRect(t,e,i,r,n,o){return this._tick++,this._activePath.chamferRect(t,e,i,r,n,o),this}star(t,e,i,r,n=0,o=0){return this._tick++,this._activePath.star(t,e,i,r,n,o,this._transform.clone()),this}svg(t){return this._tick++,Xa(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,r,n,o){return t instanceof R?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,r,n,o),this)}transform(t,e,i,r,n,o){return t instanceof R?(this._transform.append(t),this):(Ii.set(t,e,i,r,n,o),this._transform.append(Ii),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],r=i.action;if(r==="fill"){const n=i.data;t.addBounds(n.path.bounds)}else if(r==="texture"){const n=i.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(r==="stroke"){const n=i.data,o=n.style.width/2,a=n.path.bounds;t.addFrame(a.minX-o,a.minY-o,a.maxX+o,a.maxY+o)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let i=!1;for(let r=0;r<e.length;r++){const n=e[r],o=n.data,a=o.path;if(!n.action||!a)continue;const h=o.style,c=a.shapePath.shapePrimitives;for(let l=0;l<c.length;l++){const u=c[l].shape;if(!h||!u)continue;const d=c[l].transform,f=d?d.applyInverse(t,qa):t;n.action==="fill"?i=u.contains(f.x,f.y):i=u.strokeContains(f.x,f.y,h.width);const p=o.hole;if(p){const g=p.shapePath?.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(f.x,f.y)&&(i=!1)}if(i)return!0}}return i}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const i=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Ws.defaultFillStyle={color:16777215,alpha:1,texture:L.WHITE,matrix:null,fill:null};Ws.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:L.WHITE,matrix:null,fill:null};let Yt=Ws;function Ys(s,t=1){const e=Jt.RETINA_PREFIX?.exec(s);return e?parseFloat(e[1]):t}function Xs(s,t,e){s.label=e,s._sourceOrigin=e;const i=new L({source:s,label:e}),r=()=>{delete t.promiseCache[e],Z.has(e)&&Z.remove(e)};return i.source.once("destroy",()=>{t.promiseCache[e]&&(j("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),i.once("destroy",()=>{s.destroyed||(j("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),i}const Za=".svg",Ka="image/svg+xml",Qa={extension:{type:k.LoadParser,priority:Ut.Low},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return te(s,Ka)||ee(s,Za)},async load(s,t,e){return t.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?th(s):Ja(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function Ja(s,t,e,i){const n=await(await J.get().fetch(s)).blob(),o=URL.createObjectURL(n),a=new Image;a.src=o,a.crossOrigin=i,await a.decode(),URL.revokeObjectURL(o);const h=document.createElement("canvas"),c=h.getContext("2d"),l=t.data?.resolution||Ys(s),u=t.data?.width??a.width,d=t.data?.height??a.height;h.width=u*l,h.height=d*l,c.drawImage(a,0,0,u*l,d*l);const{parseAsGraphicsContext:f,...p}=t.data,g=new be({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Xs(g,e,s)}async function th(s){const e=await(await J.get().fetch(s)).text(),i=new Yt;return i.svg(e),i}const eh=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let $t=null,Ts=class{constructor(){$t||($t=URL.createObjectURL(new Blob([eh],{type:"application/javascript"}))),this.worker=new Worker($t)}};Ts.revokeObjectURL=function(){$t&&(URL.revokeObjectURL($t),$t=null)};const sh=`(function () {
    'use strict';

    async function loadImageBitmap(url) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      const imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap;
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let jt=null;class Or{constructor(){jt||(jt=URL.createObjectURL(new Blob([sh],{type:"application/javascript"}))),this.worker=new Worker(jt)}}Or.revokeObjectURL=function(){jt&&(URL.revokeObjectURL(jt),jt=null)};let Ei=0,us;class ih{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Ts;e.addEventListener("message",i=>{e.terminate(),Ts.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){us===void 0&&(us=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<us&&(this._createdWorkers++,t=new Or().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((r,n)=>{this._queue.push({id:t,arguments:e,resolve:r,reject:n})});return this._next(),i}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),i=e.id;this._resolveHash[Ei]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Ei++,id:i})}}const Bi=new ih,rh=[".jpeg",".jpg",".png",".webp",".avif"],nh=["image/jpeg","image/png","image/webp","image/avif"];async function oh(s){const t=await J.get().fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Ur={name:"loadTextures",extension:{type:k.LoadParser,priority:Ut.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return te(s,nh)||ee(s,rh)},async load(s,t,e){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Bi.isImageBitmapSupported()?i=await Bi.loadImageBitmap(s):i=await oh(s):i=await new Promise(n=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?n(i):i.onload=()=>{n(i)}});const r=new be({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||Ys(s),...t.data});return Xs(r,e,s)},unload(s){s.destroy(!0)}},Nr=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],ah=Nr.map(s=>`video/${s.substring(1)}`);function hh(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=ch(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function lh(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",i),s.addEventListener("error",r),s.load();function i(){n(),t()}function r(o){n(),e(o)}function n(){s.removeEventListener("canplaythrough",i),s.removeEventListener("error",r)}})}function ch(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const uh={name:"loadVideo",extension:{type:k.LoadParser},config:null,test(s){const t=te(s,ah),e=ee(s,Nr);return t||e},async load(s,t,e){const i={...De.defaultOptions,resolution:t.data?.resolution||Ys(s),alphaMode:t.data?.alphaMode||await cr(),...t.data},r=document.createElement("video"),n={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(n).forEach(h=>{const c=n[h];c!==void 0&&r.setAttribute(h,c)}),i.muted===!0&&(r.muted=!0),hh(r,s,i.crossorigin);const o=document.createElement("source");let a;if(s.startsWith("data:"))a=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const h=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();a=De.MIME_TYPES[h]||`video/${h}`}return o.src=s,a&&(o.type=a),new Promise(h=>{const c=async()=>{const l=new De({...i,resource:r});r.removeEventListener("canplay",c),t.data.preload&&await lh(r),h(Xs(l,e,s))};r.addEventListener("canplay",c),r.appendChild(o)})},unload(s){s.destroy(!0)}},zr={extension:k.ResolveParser,test:Ur.test,parse:s=>({resolution:parseFloat(Jt.RETINA_PREFIX.exec(s)?.[1]??"1"),format:s.split(".").pop(),src:s})},dh={extension:k.ResolveParser,test:s=>Jt.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:zr.parse};class fh{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Jt,this.loader=new Bo,this.cache=Z,this._backgroundLoader=new vo(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){j("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let n=t.manifest;typeof n=="string"&&(n=await this.load(n)),this.resolver.addManifest(n)}const e=t.texturePreference?.resolution??1,i=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=ze(t),r=ct(t).map(a=>{if(typeof a!="string"){const h=this.resolver.getAlias(a);return h.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return i?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const c=()=>{e?.(++a/h)},l=o.map(u=>{const d=r[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,c).then(f=>{n[u]=f})});return await Promise.all(l),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Z.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=Z.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(i,e);this._backgroundLoader.active=!0;const n={};return i.forEach(o=>{const a=r[o.src],h=[o.src];o.alias&&h.push(...o.alias),h.forEach(c=>{n[c]=a}),Z.set(h,a)}),n}async unload(t){this._initialized||await this.init();const e=ct(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=ct(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{Z.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,r)=>e.indexOf(i)===r),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const Gt=new fh;nt.handleByList(k.LoadParser,Gt.loader.parsers).handleByList(k.ResolveParser,Gt.resolver.parsers).handleByList(k.CacheParser,Gt.cache.parsers).handleByList(k.DetectionParser,Gt.detections);nt.add(Mo,Po,Co,Eo,To,ko,Io,Lo,Oo,Vo,Qa,Ur,uh,zr,dh);const Ri={loader:k.LoadParser,resolver:k.ResolveParser,cache:k.CacheParser,detection:k.DetectionParser};nt.handle(k.Asset,s=>{const t=s.ref;Object.entries(Ri).filter(([e])=>!!t[e]).forEach(([e,i])=>nt.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(Ri).filter(e=>!!t[e]).forEach(e=>nt.remove(t[e]))});class dt extends K{constructor(t){t instanceof Yt&&(t={context:t});const{context:e,roundPixels:i,...r}=t||{};super({label:"Graphics",...r}),this.canBundle=!0,this.renderPipeId="graphics",this._roundPixels=0,e?this._context=e:this._context=this._ownedContext=new Yt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}onViewUpdate(){this._didChangeId+=4096,this._didGraphicsUpdate=!0,!this.didViewUpdate&&(this.didViewUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new dt(this._context.clone()):(this._ownedContext=null,new dt(this._context))}lineStyle(t,e,i){H(z,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),i&&(r.alpha=i),this.context.strokeStyle=r,this}beginFill(t,e){H(z,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return t&&(i.color=t),e&&(i.alpha=e),this.context.fillStyle=i,this}endFill(){H(z,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Yt.defaultStrokeStyle.width||t.color!==Yt.defaultStrokeStyle.color||t.alpha!==Yt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return H(z,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return H(z,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return H(z,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return H(z,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return H(z,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return H(z,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}nt.add(Kr,Qr);let Oe={bundles:[]};const Fi=[];function ph(s){return!!Oe.bundles.find(t=>t.name===s)}async function mh(s){typeof s=="string"&&(s=[s]);for(const e of s)if(!ph(e))throw new Error(`[Assets] Invalid bundle: ${e}`);const t=s.filter(e=>!Fi.includes(e));t.length&&(console.log("[Assets] Load:",t.join(", ")),await Gt.loadBundle(t),Fi.push(...t))}async function gh(s){const e=await(await fetch(s)).json();if(!e.bundles)throw new Error("[Assets] Invalid assets manifest");return e}async function yh(){Oe=await gh("/assets/assets-manifest.json"),await Gt.init({manifest:Oe,basePath:"/assets"}),await mh("images");const s=Oe.bundles.map(t=>t.name);Gt.backgroundLoadBundle(s)}const qt=17,_h=5,Hr=5,Vs=3875851,Ge=33182,xh=30,Nt=["Great, now that you understand the history, let's actually build a well. Start by pressing the build button.","Following the guideline, drag to drill a wellbore into the Earth. This will go through the layers of sediment and rock until it reaches our targeted shale formation. We can also extend our wellbore horizontally and make it go through the shale reservoir to help maximize the amount of contact.","If you're happy with the drill hole, press continue. Otherwise, you can retry your hole to match the guidelines again.","Now we need to add some casing, made with both concrete and metal to protect the fracking fluid from seeping into other layers of sediment, and to prevent the oil and gas we collect from leaking out. Hold the fill button until the casing is in.","Time to perforate the shale reservoir. We'll lay some explosives to add holes into the shale.","Lastly, we need to add our highly pressurized fracking fluid into the drill hole to fracture the shale! The fluid is includes water, sand, and chemicals. The sand here serves as a proppant, keeping the cracks open, allowing the hydrocarbons to flow more freely to the surface. The chemical additives in the fluid also help keep the process efficient by reducing friction and preventing bacterial growth within the wellbore.","Perfect! We did it, all those fractures should release the oil and gas trapped in the shale and the pressure will push oil, gas, and flowback water back to the surface."];var bh=document.getElementById("canvas-container");const B=new vr;await B.init({width:800,height:600,preference:"webgl",backgroundColor:13421772});bh.appendChild(B.canvas);await yh();var bt;const wh={x:100,y:180};var Wt;const Ah={x:115,y:130};var Li,Xt,mt,gt,W,wt,it;let we;var Gi,ks,Is,Es,He=[],Wr;const $s={x:300,y:100},vh={x:300,y:160},Mh={x:300,y:300},Di=[12974590,9225025,9003323,7818022,2599136,5588801,7562070,13479053],We=[250,10,20,40,30,60,30,100],Ch=[{x:160,y:260},{x:160,y:400},{x:161.37,y:415.63},{x:165.43,y:430.78},{x:172.06,y:445},{x:181.06,y:457.85},{x:192.15,y:468.94},{x:205,y:477.94},{x:219.22,y:484.57},{x:234.37,y:488.63},{x:250,y:490},{x:600,y:490}],me=[[{x:300,y:460},{x:300,y:520}],[{x:350,y:460},{x:350,y:520}],[{x:400,y:460},{x:400,y:520}],[{x:450,y:460},{x:450,y:520}],[{x:500,y:460},{x:500,y:520}],[{x:550,y:460},{x:550,y:520}]],Bs=[];let ut=[];var Oi=document.getElementById("chat-p");Ph();function Ph(){B.stage.eventMode="static",B.stage.hitArea=B.screen,Sh(),bt=ot.from("build-well-button"),bt.width=120,bt.height=40,bt.position=wh,bt.eventMode="static",bt.cursor="pointer",bt.on("pointerdown",Yr),B.stage.addChild(bt),zt(Nt[0])}function Sh(s=0){const t=B.screen.width;let e=0,i=new dt;for(let r=0;r<Di.length;r++)s<=r&&(i.rect(0,e,t,We[r]),i.fill(Di[r])),e+=We[r];B.stage.addChild(i)}function Yr(){B.stage.removeChild(bt),Wt=ot.from("oil-well"),Wt.width=90,Wt.height=120,Wt.position=Ah,Wt.on("pointerdown",Yr),B.stage.addChild(Wt),Li=new dt,Xr(),Ot(Li,Ch,_h,10358019)}function Xr(){zt(Nt[1]),Xt=new dt,B.stage.on("pointerdown",e),B.stage.on("pointermove",i),B.stage.on("pointerup",r);let s=!1,t=null;function e(n){s=!0,t=n.data.getLocalPosition(B.stage),t.y<We[0]+qt/2&&(console.log("Uhoh, you drilled above the ground!"),t=null)}function i(n){if(!s)return;let o=n.data.getLocalPosition(B.stage);if(o.y<We[0]+qt/2){console.log("Uhoh, you drilled above the ground!"),t=null;return}t==null&&(t=o),Xt.moveTo(t.x,t.y),Xt.lineTo(o.x,o.y),Xt.stroke({width:qt,color:Vs,cap:"round"}),ut.push(t),B.stage.addChild(Xt),t=o}function r(){t!=null&&ut.push(t),s=!1,t=null,ut.length>0&&(Th(),B.stage.off("pointerdown",e),B.stage.off("pointermove",i),B.stage.off("pointerup",r))}}function Th(){mt=ot.from("continue-button"),mt.width=120,mt.height=40,mt.position=vh,mt.eventMode="static",mt.cursor="pointer",mt.on("pointerdown",Ih),B.stage.addChild(mt),gt=ot.from("retry-button"),gt.width=120,gt.height=40,gt.position=$s,gt.eventMode="static",gt.cursor="pointer",gt.on("pointerdown",kh),B.stage.addChild(gt),zt(Nt[2])}function kh(){B.stage.removeChild(Xt),ut=[],Xr(),B.stage.removeChild(mt),B.stage.removeChild(gt)}function Ih(){B.stage.removeChild(mt),B.stage.removeChild(gt),W=ot.from("fill-hole-button"),W.width=120,W.height=40,W.position=$s,W.eventMode="static",W.cursor="pointer",W.on("pointerdown",Eh),W.on("pointerup",Rh),ks=new dt,Is=new dt,B.stage.addChild(W),it=0,zt(Nt[3])}function Eh(){we=setInterval(Bh,1)}function Bh(){it+=1,ks.clear(),Is.clear(),Ot(ks,ut.slice(0,it),qt,13224393),Ot(Is,ut,qt-8,Vs),it>ut.length&&(clearInterval(we),Fh())}function Rh(){clearInterval(we)}function Fh(){B.stage.removeChild(W),wt=ot.from("perforation-button"),wt.width=120,wt.height=40,wt.position=Mh,wt.eventMode="static",wt.cursor="pointer",wt.on("pointerdown",Lh),B.stage.addChild(wt),zt(Nt[4])}function Lh(){for(let s=0;s<me.length;s++)He[s]=new dt,Ot(He[s],me[s],Hr,Vs),Bs[s]=!1;B.stage.removeChild(wt),Gh(),zt(Nt[5])}function Gh(){W=ot.from("fill-hole-button"),W.width=120,W.height=40,W.position=$s,W.eventMode="static",W.cursor="pointer",W.on("pointerdown",Dh),B.stage.addChild(W),it=0,Es=new dt,Wr=new dt}function Dh(){B.stage.removeChild(W),it<=0&&(we=setInterval(Oh,1))}function Oh(){it+=2,Es.clear(),Ot(Es,ut.slice(0,it),qt-8,Ge),it=Math.min(it,ut.length-1);for(let s=0;s<me.length;s++){let t=me[s];ut[it].x>t[0].x&&!Bs[s]&&(He[s].clear(),Ot(He[s],me[s],Hr,Ge),Ui(t[0],5,10,20,4,Ge),Ui(t[1],5,10,20,4,Ge),Bs[s]=!0)}it>=ut.length-1&&(Uh(),clearInterval(we))}function Ui(s,t,e,i,r,n){for(let o=0;o<t;o++){const a=Math.random()*Math.PI*2,h=Math.random()*(i-e)+e,c=s.x+Math.cos(a)*h,l=s.y+Math.sin(a)*h;Ot(Wr,[s,{x:c,y:l}],r,n)}}function Uh(){zt(Nt[6]),document.getElementById("continue-button").style.display="block"}function Ot(s,t,e,i){for(let r=0;r<t.length-1;r++)s.moveTo(t[r].x,t[r].y),s.lineTo(t[r+1].x,t[r+1].y),s.stroke({width:e,color:i,cap:"round"}),B.stage.addChild(s)}function zt(s){clearInterval(Gi),Oi.textContent="";let t=0;const e=()=>{t<s.length&&(Oi.textContent+=s[t],t++,Gi=setTimeout(e,xh))};e()}function Nh(s,t,e){let i=Math.abs(t.x-s.x),r=s.x+i,n=s.y,o=Math.PI*1.5,h=(Math.PI-o)/(e-1),c="[";for(let l=0;l<e;l++){let u=o-h*l,d=r+i*Math.sin(u),f=n+i*Math.cos(u);c+=`{ x: ${d.toFixed(2)}, y: ${f.toFixed(2)} }, `}return c=c.slice(0,-2)+"]",c}let zh={x:160,y:400},Hh={x:250,y:490},Wh=10,Yh=Nh(zh,Hh,Wh);console.log(Yh);export{Ut as $,wr as A,Q as B,K as C,J as D,k as E,Mn as F,Dn as G,is as H,st as I,Qi as J,H as K,z as L,Pr as M,ia as N,Kt as O,q as P,Ht as Q,V as R,ca as S,ke as T,ys as U,Yt as V,$a as W,ja as X,be as Y,Z,Er as _,Ct as a,yt as a0,mi as a1,dt as a2,un as a3,Rr as a4,xe as b,Kn as c,_r as d,nt as e,wi as f,aa as g,hr as h,Pt as i,R as j,L as k,cn as l,ua as m,$h as n,oa as o,lt as p,Zi as q,An as r,vt as s,ot as t,$ as u,Jn as v,j as w,_o as x,ma as y,fi as z};
